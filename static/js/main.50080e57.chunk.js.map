{"version":3,"sources":["components/react-diagrams/custom-port/MyPortLabelWidget.tsx","components/react-diagrams/custom-node/custom_components/EditableSingleField.tsx","components/react-diagrams/custom-node/custom_components/SelectableField.tsx","components/react-diagrams/editableNode/MyEditableNodeWidget.tsx","components/react-diagrams/editableNode/MyEditableNodeFactory.tsx","components/react-diagrams/custom-link-label/EditableLabelModel.ts","components/react-diagrams/custom-link-label/EditableLabelWidget.tsx","components/react-diagrams/custom-link-label/EditableLabelFactory.tsx","components/react-diagrams/Application.ts","components/GoClass.tsx","components/goBuilder.ts","components/react-diagrams/TrayItemWidget.tsx","components/react-diagrams/MyCanvasWidget.tsx","components/react-diagrams/myNode/MyRightAngleLinkModel.ts","components/react-diagrams/myNode/MyPortModel.ts","components/react-diagrams/editableNode/MyEditableNodeModel.ts","PaletteNodes.jsx","components/Code.tsx","pages/Editor.tsx","App.tsx","index.tsx"],"names":["S","styled","div","props","border","width","height","background","hasLink","MyPortLabel","Object","keys","this","port","links","length","hasHiddenLabel","getOptions","extras","isVoid","name","startsWith","alignment","FakePort","engine","Port","labelR","LabelR","label","labelL","LabelL","PortLabel","in","React","Editor","content","onFocus","onChange","onBlurOrEnter","autoFocus","inputStyle","padding","borderStyle","borderWidth","borderColor","type","value","onBlur","onKeyDown","event","keyCode","EditableSingleField","state","beingEdited","editingKey","elementKey","node","setLocked","style","margin","fontStyle","isAbstract","options","id","map","x","y","SelectableField","returnTypes","portTypes","p","selected","MyEditableNodeWidget","divElement","generatePort","getID","_editableObjectDoubleClick","editingSomething","setState","_contentOnChange","evt","nodeModel","currentTarget","_onBlurOrEnter","replaceAll","variableType","bind","Node","isSelected","color","Title","hasReturnType","className","ref","onDoubleClick","returnType","hasPortType","portType","hasUsername","TitleName","hasUsages","fontSize","marginBottom","place","delayHide","effect","Button","onClick","addInPort","addOutPort","repaintCanvas","isFound","index","portsIn","portIn","portOut","portsOut","removePort","portIndex","nameIn","nameOut","next","filter","hasValue","selectableOptions","Ports","PortsContainer","_","getInPorts","getOutPorts","MyEditableNodeFactory","Error","model","AbstractReactFactory","EditableLabelModel","data","LabelModel","EditableLabelWidget","str","setStr","Label","newVal","target","action","EditableLabelFactory","Application","activeModel","diagramEngine","SRD","getNodeFactories","registerFactory","getLinkFactories","RightAngleLinkFactory","getLabelFactories","newModel","setModel","GoClass","initDiagram","$","go","make","myDiagram","layout","angle","isTree","path","PathSource","setsPortSpot","setsChildPortSpot","arrangement","ArrangementHorizontal","undefined","nodeSpacing","layerSpacing","convertVisibility","v","propertyTemplate","isMultiline","editable","makeTwoWay","s","t","methodTemplate","nodeTemplate","locationSpot","Center","fromSpot","AllSides","toSpot","fill","minSize","hasMinSize","defaultRowSeparatorStroke","row","columnSpan","font","ofObject","stretch","Fill","defaultAlignment","Left","itemTemplate","column","TopRight","visible","arr","nodeTemplateMap","add","desiredSize","parse","stringify","stroke","strokeWidth","linkTemplate","routing","Orthogonal","r","scale","textAlign","linkKeyProperty","copiesArrays","copiesArrayObjects","diagramOptions","divClassName","nodeDataArray","nodedata","linkDataArray","linkdata","controllerDelta","methodDelta","getGoProperties","properties","entries","key","push","visibility","getGoMethods","methods","ports","forEach","method","ins","outs","TrayItemWidget","Tray","highlighted","draggable","onDragStart","dataTransfer","setData","JSON","setDragImage","Image","float","marginRight","description","href","link","rel","css","MyCanvasWidget","styles","Expand","Container","children","MyRightAngleLinkModel","NAME","lastHoverIndexOfPath","_lastPathXdirection","_firstPathXdirection","points","getPoints","i","dx","Math","abs","getX","dy","getY","pointModel","setFirstAndLastPathsDirection","first","last","fireEvent","DefaultLinkModel","MyPortModel","PortModelAlignment","LEFT","RIGHT","setWidth","setTimeout","values","getSourcePort","getParent","getPorts","linkQuantity","reduce","acc","l","setColor","seed","floor","sin","toString","console","log","genColor","error","PortModel","MyEditableNodeModel","biPort","inPort","outPort","lookupTable","clone","splice","indexOf","after","addPort","oldName","newName","portInIndex","findIndex","portsInOrder","getPortFromID","portsOutOrder","NodeModel","analogPorts","digitalPorts","group","Array","from","library","ordinals","paramTypes","generateCode","declareFunction","logic","find","processLink","formattedParameters","params","par","message","m","code","getLink","linkID","getPort","nodeID","portID","nodes","n","getNode","childNode","parentNode","warn","problems","getCoditionalValue","conditionNode","portName","source","sourcePort","parent","includes","instance","getOutcome","ifThis","targetPort","fromPort","fromNode","toPort","resolveTarget","toNode","nextFromPort","portPosition","outPortId","getOutPort","nextLink","nextToPort","nextToNode","expected","split","received","expMin","e","expMax","count","warnAboutExpectedVersusReceived","ex","expectedType","rt","trim","re","receivedType","substring","variableParams","xValue","yValue","outcomePort2","toNode2","outcomePort3","toNode3","callWithParameters","functions","temp","layers","models","getLinksFromModel","getNodesFromModel","logics","components","toLowerCase","replace","getComponentsFromNodes","controller","constants","constant","toUpperCase","variables","usedDigital","Set","usedAnalog","uniqueDigitals","u","uniqueAnalogs","addHeaderComments","controllers","warnAboutNumberOfControllers","warnAboutNodesWithoutLinks","warnAboutMultipleUsePorts","warnAboutLooseLinks","libraries","component","lib","comp","addLibraries","isArray","addConstantDeclarations","variable","equals","addVariableDeclarations","original","level","line","repeat","max","join","indentCode","Code","uniqueProblems","problem","self","useEffect","Prism","highlightAll","problemNodes","pn","el","document","querySelector","setAttribute","badMethod","to","text","relationship","methodIndex","processDynamic","problemId","display","justifyContent","start","end","overflow","ScrollArea","require","default","app","EditorPage","useState","rerender","setRerender","rawModel","getDiagramEngine","getModel","serialize","stringModel","groups","PaletteNodes","Body","Content","speed","contentClassName","horizontal","smoothScrolling","verticalScrollbarStyle","backgroundColor","slice","Layer","onDrop","getData","registerListener","linksUpdated","nodesUpdated","setPosition","getRelativeMousePoint","addNode","onDragOver","preventDefault","App","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.50080e57.chunk.js","sourcesContent":["import * as React from 'react';\r\nimport { DiagramEngine, PortWidget } from '@projectstorm/react-diagrams-core';\r\nimport styled from '@emotion/styled';\r\nimport { MyPortModel } from '../myNode/MyPortModel';\r\n\r\nexport interface MyPortLabelProps {\r\n    port: MyPortModel;\r\n    engine: DiagramEngine;\r\n}\r\n\r\nnamespace S {\r\n    export const PortLabel = styled.div`\r\n\t\tdisplay: flex;\r\n\t\tmargin-top: 1px;\r\n\t\talign-items: center;\r\n\t`;\r\n\r\n    export const LabelR = styled.div`\r\n\t\tpadding: 0 4px 0 0;\r\n\t\tflex-grow: 1;\r\n\t`;\r\n\r\n    export const LabelL = styled.div`\r\n\t\tpadding: 0 0 0px 0;\r\n\t\tflex-grow: 1;\r\n\t`;\r\n\r\n    export const Port = styled.div((props: any) => ({\r\n        border: 'solid 1px white',\r\n        width: '14px',\r\n        height: '14px',\r\n        background: (props.hasLink ? 'rgba(255, 192, 0, 0.7)' : 'rgba(255, 255, 255, 0.3)'),\r\n        '&:hover': {\r\n            background: 'rgb(192, 255, 0)',\r\n        }\r\n    }))\r\n\r\n\r\n    export const FakePort = styled.div`\r\n        width: 16px;\r\n\t\theight: 16px;\r\n\t`;\r\n}\r\nexport class MyPortLabel extends React.Component<MyPortLabelProps> {\r\n    render() {\r\n        const hasLink = Object.keys(this.props?.port?.links).length !== 0\r\n        const hasHiddenLabel = this.props?.port?.getOptions().extras.hasHiddenLabel\r\n        let isVoid = false\r\n        if (this.props?.port?.getOptions().name?.startsWith('void')) {\r\n            if (this.props?.port?.getOptions().alignment === \"right\") {\r\n                isVoid = true\r\n            }\r\n        }\r\n        const port = isVoid ? (<S.FakePort />) : (\r\n            <PortWidget engine={this.props.engine\r\n            } port={this.props.port} >\r\n                <S.Port hasLink={hasLink} />\r\n            </PortWidget>\r\n        );\r\n\r\n        const labelR = <S.LabelR>{this.props.port.getOptions().label}</S.LabelR>;\r\n        const labelL = <S.LabelL>{this.props.port.getOptions().label}</S.LabelL>;\r\n\r\n        return (\r\n            <S.PortLabel>\r\n                {this.props.port.getOptions().in ? port : !hasHiddenLabel && labelR}\r\n                {this.props.port.getOptions().in ? !hasHiddenLabel && labelL : port}\r\n            </S.PortLabel>\r\n        );\r\n    }\r\n}","import * as React from \"react\";\r\nimport AutosizeInput from 'react-input-autosize';\r\n\r\nexport interface IEditableSingleFieldProps {\r\n  node: any;\r\n  beingEdited: boolean;\r\n  content: string;\r\n  onFocus: (evt: React.FormEvent<HTMLInputElement>) => void;\r\n  onChange: (evt: React.FormEvent<HTMLInputElement>) => void;\r\n  onBlurOrEnter: () => void;\r\n  editingKey: string;\r\n  elementKey: string;\r\n  isAbstract?: boolean;\r\n}\r\nconst Editor = ({\r\n  content,\r\n  onFocus,\r\n  onChange,\r\n  onBlurOrEnter,\r\n}: {\r\n  content: string;\r\n  onFocus: (evt: React.FormEvent<HTMLInputElement>) => void;\r\n  onChange: (evt: React.FormEvent<HTMLInputElement>) => void;\r\n  onBlurOrEnter: () => void;\r\n}) => {\r\n  return (\r\n    <AutosizeInput\r\n      autoFocus\r\n      inputStyle={{\r\n        padding: 1,\r\n        borderStyle: \"dotted\",\r\n        borderWidth: 1,\r\n        borderColor: \"black\"\r\n      }}\r\n      type=\"text\"\r\n      value={content}\r\n      onChange={onChange}\r\n      onFocus={onFocus}\r\n      onBlur={onBlurOrEnter}\r\n      onKeyDown={(event: any) => {\r\n        if (event.keyCode === 13) onBlurOrEnter();\r\n      }}\r\n    />\r\n  );\r\n};\r\n\r\nexport default class EditableSingleField extends React.Component<\r\n  IEditableSingleFieldProps\r\n> {\r\n  constructor(props: IEditableSingleFieldProps) {\r\n    super(props);\r\n    this.state = {};\r\n    // console.log('node', this.props.node)\r\n  }\r\n\r\n  public render() {\r\n    return (\r\n      <div>\r\n        {this.props.beingEdited &&\r\n          this.props.editingKey === this.props.elementKey ? (\r\n          <Editor\r\n            content={this.props.content}\r\n            onFocus={() => this.props.node.setLocked(true)}\r\n            onChange={this.props.onChange}\r\n            onBlurOrEnter={() => {\r\n              this.props.node.setLocked(false)\r\n              this.props.onBlurOrEnter()\r\n            }}\r\n          />\r\n        ) : (\r\n          <p\r\n            style={{\r\n              margin: 0,\r\n              padding: 0,\r\n              fontStyle: this.props.isAbstract ? \"italic\" : \"normal\"\r\n            }}\r\n          >\r\n            {this.props.content}\r\n          </p>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import * as React from \"react\";\r\n\r\nexport interface ISelectableFieldProps {\r\n  beingEdited: boolean;\r\n  options: Array<string>\r\n  content: string;\r\n  onChange: (evt: React.ChangeEvent<HTMLSelectElement>) => void;\r\n  onBlurOrEnter: () => void;\r\n  editingKey: string;\r\n  elementKey: string;\r\n  isAbstract?: boolean;\r\n}\r\n\r\nexport interface ISelectableFieldState { }\r\n\r\nconst Editor = ({\r\n  content,\r\n  onChange,\r\n  onBlurOrEnter,\r\n  options\r\n}: {\r\n  content: string;\r\n  onChange: (evt: React.ChangeEvent<HTMLSelectElement>) => void;\r\n  onBlurOrEnter: () => void;\r\n  options: Array<string>;\r\n}) => {\r\n  return (\r\n    <select name=\"values\" id=\"values\"\r\n      value={content}\r\n      onChange={onChange}\r\n      onBlur={onBlurOrEnter}\r\n    >\r\n      {\r\n        options.map((x, y) =>\r\n          <option key={y}>{x}</option>)\r\n      }\r\n    </select>\r\n  );\r\n};\r\n\r\nexport default class SelectableField extends React.Component<\r\n  ISelectableFieldProps,\r\n  ISelectableFieldState\r\n> {\r\n  constructor(props: ISelectableFieldProps) {\r\n    super(props);\r\n    this.state = {};\r\n  }\r\n\r\n  public render() {\r\n    return (\r\n      <div>\r\n        {this.props.beingEdited &&\r\n          this.props.editingKey === this.props.elementKey ? (\r\n          <Editor\r\n            content={this.props.content}\r\n            onChange={this.props.onChange}\r\n            onBlurOrEnter={this.props.onBlurOrEnter}\r\n            options={this.props.options}\r\n          />\r\n        ) : (\r\n          <p\r\n            style={{\r\n              margin: 0,\r\n              padding: 0,\r\n              fontStyle: this.props.isAbstract ? \"italic\" : \"normal\"\r\n            }}\r\n          >\r\n            {this.props.content}\r\n          </p>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","/* eslint-disable jsx-a11y/anchor-is-valid */\r\n//@ts-nocheck\r\nimport * as React from \"react\";\r\nimport { MyEditableNodeModel } from \"./MyEditableNodeModel\";\r\nimport \"./MyEditableNodeWidgedStyle.css\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { DiagramEngine } from \"@projectstorm/react-diagrams\";\r\nimport { MyPortLabel } from \"../custom-port/MyPortLabelWidget\"\r\nimport styled from '@emotion/styled';\r\n\r\nimport EditableSingleField from \"../custom-node/custom_components/EditableSingleField\";\r\nimport SelectableField from \"../custom-node/custom_components/SelectableField\";\r\n\r\nimport ReactTooltip from 'react-tooltip';\r\nimport OpenInNewIcon from '@mui/icons-material/OpenInNew';\r\n\r\nimport { Button } from '@material-ui/core';\r\n\r\nconst returnTypes = ['byte', 'uint8_t', 'uint16_t', 'int32_t', 'unsigned int', 'unsigned long', 'int', 'long', 'bool', 'float', 'double', 'char', 'string']\r\nconst portTypes = ['Digital', 'Analog']\r\n\r\nnamespace S {\r\n  export const Node = styled.div<{ background: string; selected: boolean }>`\r\n\t\tbackground-color: ${(p) => p.background};\r\n\t\tborder-radius: 5px;\r\n\t\tfont-family: sans-serif;\r\n\t\tcolor: white;\r\n\t\tborder: solid 2px black;\r\n\t\toverflow: visible;\r\n\t\tfont-size: 11px;\r\n\t\tborder: solid 2px ${(p) => (p.selected ? 'rgb(0,192,255)' : 'black')};\r\n\t`;\r\n\r\n  export const Title = styled.div`\r\n\t\tbackground: rgba(0, 0, 0, 0.3);\r\n\t\tdisplay: flex;\r\n\t\twhite-space: nowrap;\r\n\t\tjustify-items: center;\r\n\t`;\r\n\r\n  export const TitleName = styled.div`\r\n\t\tflex-grow: 1;\r\n\t\tpadding: 5px 5px;\r\n\t`;\r\n\r\n  export const Ports = styled.div`\r\n\t\tdisplay: flex;\r\n\t\tbackground-image: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2));\r\n\t`;\r\n\r\n  export const PortsContainer = styled.div`\r\n\t\tflex-grow: 1;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\r\n\t\t&:first-of-type {\r\n\t\t\tmargin-right: 4px;\r\n\t\t}\r\n\r\n\t\t&:only-child {\r\n\t\t\tmargin-right: 0px;\r\n\t\t}\r\n\t`;\r\n}\r\n\r\nexport interface MyEditableWidgetProps {\r\n  nodeModel: MyEditableNodeModel;\r\n  engine: DiagramEngine\r\n}\r\n\r\nexport interface MyEditableWidgetState {\r\n  content: string;\r\n  height: number;\r\n  width: number;\r\n  editingSomething: boolean;\r\n  editingKey: string;\r\n}\r\nexport class MyEditableNodeWidget extends React.Component<\r\n  MyEditableWidgetProps,\r\n  MyEditableWidgetState\r\n> {\r\n  private divElement: HTMLDivElement;\r\n\r\n  constructor(props: MyEditableWidgetProps) {\r\n    super(props);\r\n    this.state = {\r\n      content: { name: '', value: '' },\r\n      variableType: '',\r\n      editingSomething: false,\r\n      editingKey: \"\"\r\n    };\r\n\r\n    //binding the methods to this element\r\n    this._editableObjectDoubleClick = this._editableObjectDoubleClick.bind(this);\r\n    this._contentOnChange = this._contentOnChange.bind(this);\r\n    this._onBlurOrEnter = this._onBlurOrEnter.bind(this);\r\n  }\r\n  generatePort = (port) => {\r\n    return <MyPortLabel engine={this.props.engine} port={port} key={port.getID()} />\r\n  };\r\n\r\n  /**\r\n   * Pass this on onDoubleClick.\r\n   * You change the states to make the fields know it's in edit mode, and tell who is in the edit mode\r\n   */\r\n  _editableObjectDoubleClick = (content: string) => {\r\n    if (this.state.editingSomething) return;\r\n    this.setState({\r\n      editingSomething: true,\r\n      editingKey: content\r\n    });\r\n  };\r\n\r\n  /**\r\n   * What you'll do when the content is changed\r\n   * Usually, you update the model and the state\r\n   */\r\n  _contentOnChange = (evt: React.FormEvent<HTMLInputElement>) => {\r\n    this.props.nodeModel.extras[this.state.editingKey] = evt.currentTarget.value;\r\n    this.setState({ content: evt.currentTarget.value });\r\n  };\r\n\r\n  /**\r\n   * What you will do when the InputField lost focus or you press enter\r\n   * Usually, you change the states to make the fields know it's not in edit mode\r\n   */\r\n  _onBlurOrEnter = () => {\r\n\r\n    if (this.props.nodeModel.getOptions().name === 'Function') {\r\n      //   //remove whitespaces from function name\r\n      this.props.nodeModel.extras.value = this.props.nodeModel.extras.value.replaceAll(' ', '')\r\n      //   this.props.engine.repaintCanvas();\r\n\r\n      //   //add returnType to inPorts labels\r\n      //   this.props.nodeModel.getInPorts().forEach(port => {\r\n      //     const name = port.getOptions().name\r\n      //     if (name === 'declare') return\r\n\r\n      //     let newName = name.substring(name.indexOf('in('))//removes previous returnType\r\n      //     newName = this.props.nodeModel.extras.returnType + ' ' + newName //adds new\r\n\r\n      //     this.props.nodeModel.renamePort(name, newName)\r\n      //   });\r\n      //   this.props.engine.repaintCanvas();\r\n      //   //this will be used for treating parameters\r\n      //   // const pos = name.indexOf('-') !== -1 ? name.indexOf('-') : name.length\r\n      //   // const newName = name.substring(0, name.indexOf('(')) + name.substring(name.indexOf(')'))\r\n      //   // this.props.nodeModel.extras.value = prev + `(${this.props.nodeModel.extras.returnType} x)`//add new\r\n    }\r\n\r\n    this.setState({\r\n      editingSomething: false,\r\n      editingKey: \"\"\r\n    });\r\n  };\r\n\r\n  /**\r\n   * copy atributes from nodeModel\r\n   */\r\n  UNSAFE_componentWillMount() {\r\n    this.setState({\r\n      extras: this.props.nodeModel.extras\r\n    });\r\n  }\r\n  render() {\r\n    // console.log(this.props.nodeModel)\r\n    return (\r\n      <S.Node\r\n        data-default-node-name={this.props.nodeModel.getOptions().name}\r\n        selected={this.props.nodeModel.isSelected()}\r\n        background={this.props.nodeModel.getOptions().color}>\r\n        <S.Title>\r\n          {this.props.nodeModel.extras.hasReturnType && <div className={\"editable-node\"}\r\n            ref={divElement => (this.divElement = divElement)}>\r\n            <div className=\"editable-border\">\r\n              <div className=\"editable-header\">\r\n                <div\r\n                  onDoubleClick={() => {\r\n                    this._editableObjectDoubleClick(\"returnType\");\r\n                  }}\r\n                >\r\n                  <SelectableField\r\n                    elementKey=\"returnType\"\r\n                    options={returnTypes}\r\n                    editingKey={this.state.editingKey}\r\n                    beingEdited={this.state.editingSomething}\r\n                    content={this.props.nodeModel.extras.returnType}\r\n                    onChange={this._contentOnChange}\r\n                    onBlurOrEnter={this._onBlurOrEnter}\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>}\r\n          {this.props.nodeModel.extras.hasPortType && <div className={\"editable-node\"}\r\n            ref={divElement => (this.divElement = divElement)}>\r\n            <div className=\"editable-border\">\r\n              <div className=\"editable-header\">\r\n                <div\r\n                  onDoubleClick={() => {\r\n                    this._editableObjectDoubleClick(\"portType\");\r\n                  }}\r\n                >\r\n                  <SelectableField\r\n                    elementKey=\"portType\"\r\n                    options={portTypes}\r\n                    editingKey={this.state.editingKey}\r\n                    beingEdited={this.state.editingSomething}\r\n                    content={this.props.nodeModel.extras.portType}\r\n                    onChange={this._contentOnChange}\r\n                    onBlurOrEnter={this._onBlurOrEnter}\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>}\r\n          {this.props.nodeModel.extras.hasUsername && <div className={\"editable-node\"}\r\n            ref={divElement => (this.divElement = divElement)}>\r\n            <div className=\"editable-border\">\r\n              <div className=\"editable-header\">\r\n                <div\r\n                  onDoubleClick={() => {\r\n                    this._editableObjectDoubleClick(\"name\");\r\n                  }}\r\n                >\r\n                  <EditableSingleField\r\n                    node={this.props.nodeModel}\r\n                    elementKey=\"name\"\r\n                    editingKey={this.state.editingKey}\r\n                    beingEdited={this.state.editingSomething}\r\n                    content={this.props.nodeModel.extras.name}\r\n                    onChange={this._contentOnChange}\r\n                    onBlurOrEnter={this._onBlurOrEnter}\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>}\r\n\r\n          <S.TitleName>\r\n            {this.props.nodeModel.getOptions().name}:\r\n            {this.props.nodeModel.extras.hasUsages &&\r\n              (<a data-tip data-for={'tip-' + this.props.nodeModel.getOptions().id} >\r\n                <OpenInNewIcon style={{ fontSize: '1rem', marginBottom: '-5px' }} />\r\n              </a>)}\r\n            <ReactTooltip\r\n              className=\"interactableTooltip\"\r\n              id={'tip-' + this.props.nodeModel.getOptions().id}\r\n              type='light'\r\n              place=\"top\"\r\n              delayHide={500}\r\n              effect=\"solid\"\r\n            >\r\n\r\n\r\n              {this.props.nodeModel.extras?.type === 'variable' &&\r\n                <div>Setters:\r\n\r\n                  <Button onClick={() => {\r\n                    const name = 'void setValue(<T> value)'\r\n                    this.props.nodeModel.addInPort(name)\r\n                    this.props.nodeModel.addOutPort(name + ' ', true, true)\r\n                    this.props.engine.repaintCanvas();\r\n                  }}> + </Button>\r\n\r\n                  <Button onClick={() => {\r\n                    const nameIn = 'void'\r\n\r\n                    let isFound = false\r\n                    let index = this.props.nodeModel.portsIn.length - 1;\r\n                    for (; index >= 1; index--) {\r\n                      const portIn = this.props.nodeModel.portsIn[index]\r\n                      const portOut = this.props.nodeModel.portsOut[index]\r\n                      if (!isFound) {\r\n                        if (Object.keys(portIn.links).length !== 0 ||\r\n                          Object.keys(portOut.links).length !== 0) {\r\n                          return\r\n                        }\r\n                        // console.log('innn', portIn)\r\n                        if (portIn.options.label.startsWith(nameIn)) {\r\n                          this.props.nodeModel.removePort(portIn)\r\n                          this.props.nodeModel.removePort(portOut)\r\n                          isFound = true\r\n                        }\r\n                      }\r\n                    }\r\n                    this.props.engine.repaintCanvas();\r\n                  }}> - </Button>\r\n                </div>\r\n              }\r\n              Usages:\r\n              <Button onClick={() => {\r\n                const portIndex = this.props.nodeModel.getOptions().name === 'Function' ? 1 : 0\r\n\r\n                const nameIn = this.props.nodeModel.portsIn[portIndex]?.getOptions()?.label\r\n                const nameOut = this.props.nodeModel.portsOut[portIndex]?.getOptions()?.label\r\n\r\n                const next = this.props.nodeModel.portsIn.filter(port => port.getOptions().label?.startsWith(nameIn)).length\r\n\r\n                if (nameIn)\r\n                  this.props.nodeModel.addInPort(nameIn + '-' + next, true)\r\n                if (nameOut)\r\n                  this.props.nodeModel.addOutPort(nameOut + '-' + next, true)\r\n                this.props.engine.repaintCanvas();\r\n              }}> + </Button>\r\n\r\n              <Button onClick={() => {\r\n                const portIndex = this.props.nodeModel.getOptions().name === 'Function' ? 1 : 0\r\n\r\n                const nameIn = this.props.nodeModel.portsIn[portIndex].getOptions().label\r\n\r\n                let isFound = false\r\n                let index = this.props.nodeModel.portsIn.length - 1;\r\n                for (; index >= portIndex + 1; index--) {\r\n                  const portIn = this.props.nodeModel.portsIn[index]\r\n                  const portOut = this.props.nodeModel.portsOut[index]\r\n\r\n                  if (!isFound) {\r\n                    if (Object.keys(portIn.links).length !== 0) {\r\n                      return\r\n                    }\r\n                    if (portIn.options.label.startsWith(nameIn)) {\r\n                      this.props.nodeModel.removePort(portIn)\r\n                      if (portOut)\r\n                        this.props.nodeModel.removePort(portOut)\r\n                      isFound = true\r\n                    }\r\n                  }\r\n                }\r\n                this.props.engine.repaintCanvas();\r\n              }}> - </Button>\r\n            </ReactTooltip>\r\n\r\n          </S.TitleName>\r\n          {this.props.nodeModel.extras.hasValue && <div className={\"editable-node\"}\r\n            ref={divElement => (this.divElement = divElement)}>\r\n            <div className=\"editable-border\">\r\n              <div className=\"editable-header\">\r\n                <div\r\n                  onDoubleClick={() => {\r\n                    this._editableObjectDoubleClick(\"value\");\r\n                  }}\r\n                >\r\n                  {this.props.nodeModel.selectableOptions || this.props.nodeModel.extras.returnType === 'bool' ?\r\n                    <SelectableField\r\n                      elementKey=\"value\"\r\n                      options={this.props.nodeModel.extras.returnType === 'bool' ? ['true', 'false'] : this.props.nodeModel.selectableOptions}\r\n                      editingKey={this.state.editingKey}\r\n                      beingEdited={this.state.editingSomething}\r\n                      content={this.props.nodeModel.extras.value}\r\n                      onChange={this._contentOnChange}\r\n                      onBlurOrEnter={this._onBlurOrEnter}\r\n                    />\r\n                    :\r\n                    <EditableSingleField\r\n                      node={this.props.nodeModel}\r\n                      elementKey=\"value\"\r\n                      editingKey={this.state.editingKey}\r\n                      beingEdited={this.state.editingSomething}\r\n                      content={this.props.nodeModel.extras.value}\r\n                      onChange={this._contentOnChange}\r\n                      onBlurOrEnter={this._onBlurOrEnter}\r\n                    />\r\n                  }\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>}\r\n        </S.Title>\r\n        <S.Ports>\r\n          <S.PortsContainer>{_.map(this.props.nodeModel.getInPorts(), this.generatePort)}</S.PortsContainer>\r\n          <S.PortsContainer>{_.map(this.props.nodeModel.getOutPorts(), this.generatePort)}</S.PortsContainer>\r\n        </S.Ports>\r\n      </S.Node>\r\n    );\r\n  }\r\n}\r\n","import { MyEditableNodeWidget } from \"./MyEditableNodeWidget\";\r\nimport { MyEditableNodeModel } from \"./MyEditableNodeModel\";\r\nimport { AbstractReactFactory, GenerateModelEvent } from '@projectstorm/react-canvas-core'\r\nimport { DiagramEngine } from \"@projectstorm/react-diagrams\";\r\n\r\nexport class MyEditableNodeFactory extends AbstractReactFactory<MyEditableNodeModel, DiagramEngine> {\r\n\tgenerateModel(event: GenerateModelEvent): MyEditableNodeModel {\r\n\t\tthrow new Error(\"Method not implemented.\");\r\n\t}\r\n\t// generateModel(event: import(\"@projectstorm/react-canvas-core\").GenerateModelEvent): MyEditableNodeModel {\r\n\t// \treturn new MyEditableNodeModel({});\r\n\t// }\r\n\tconstructor() {\r\n\t\tsuper(\"MyEditable\");\r\n\t}\r\n\r\n\tgenerateReactWidget(event: { model: MyEditableNodeModel }): JSX.Element {\r\n\t\treturn <MyEditableNodeWidget nodeModel={event.model} engine={this.engine} />;\r\n\t}\r\n}\r\n","import { LabelModel } from '@projectstorm/react-diagrams';\r\nimport { BaseModelOptions, DeserializeEvent } from '@projectstorm/react-canvas-core';\r\n\r\nexport interface EditableLabelOptions extends BaseModelOptions {\r\n    value?: string;\r\n}\r\n\r\nexport class EditableLabelModel extends LabelModel {\r\n    value: string;\r\n\r\n    constructor(options: EditableLabelOptions = {}) {\r\n        super({\r\n            ...options,\r\n            type: 'editable-label'\r\n        });\r\n        this.value = options.value || '';\r\n    }\r\n\r\n    serialize() {\r\n        return {\r\n            ...super.serialize(),\r\n            value: this.value\r\n        };\r\n    }\r\n\r\n    deserialize(event: DeserializeEvent<this>): void {\r\n        super.deserialize(event);\r\n        this.value = event.data.value;\r\n    }\r\n}","import * as React from 'react';\r\n\r\nimport { EditableLabelModel } from './EditableLabelModel';\r\nimport styled from '@emotion/styled';\r\nimport { action } from '@storybook/addon-actions';\r\n\r\nexport interface FlowAliasLabelWidgetProps {\r\n    model: EditableLabelModel;\r\n}\r\n\r\nnamespace S {\r\n    // NOTE: this CSS rules allows to interact with elements in label\r\n    export const Label = styled.div`\r\n\t\tuser-select: none;\r\n\t\tpointer-events: auto;\r\n\t`;\r\n}\r\n\r\n// now we can render all what we want in the label\r\nexport const EditableLabelWidget: React.FunctionComponent<FlowAliasLabelWidgetProps> = (props) => {\r\n    const [str, setStr] = React.useState(props.model.value);\r\n\r\n    return (\r\n        <S.Label>\r\n            <input\r\n                value={str}\r\n                onChange={(event) => {\r\n                    const newVal = event.target.value;\r\n\r\n                    // update value both in internal component state\r\n                    setStr(newVal);\r\n                    // and in model object\r\n                    props.model.value = newVal;\r\n                }}\r\n            />\r\n\r\n            <button onClick={() => action('model eventDidFire')('You clicked the button')}>Click me!</button>\r\n        </S.Label>\r\n    );\r\n};","import * as React from 'react';\r\nimport { AbstractReactFactory, GenerateWidgetEvent } from '@projectstorm/react-canvas-core';\r\nimport { DiagramEngine } from '@projectstorm/react-diagrams';\r\n\r\nimport { EditableLabelModel } from './EditableLabelModel';\r\nimport { EditableLabelWidget } from './EditableLabelWidget';\r\n\r\nexport class EditableLabelFactory extends AbstractReactFactory<EditableLabelModel, DiagramEngine> {\r\n    constructor() {\r\n        super('editable-label');\r\n    }\r\n\r\n    generateModel(): EditableLabelModel {\r\n        return new EditableLabelModel();\r\n    }\r\n\r\n    generateReactWidget(event: GenerateWidgetEvent<EditableLabelModel>): JSX.Element {\r\n        return <EditableLabelWidget model={event.model} />;\r\n    }\r\n}","import * as SRD from '@projectstorm/react-diagrams';\r\nimport { MyEditableNodeFactory } from './editableNode/MyEditableNodeFactory';\r\n\r\nimport {\r\n\tRightAngleLinkFactory,\r\n} from '@projectstorm/react-diagrams';\r\nimport { EditableLabelFactory } from './custom-link-label/EditableLabelFactory';\r\n\r\nexport class Application {\r\n\tprotected activeModel: any;//SRD.DiagramModel\r\n\tprotected diagramEngine: SRD.DiagramEngine;\r\n\r\n\tconstructor() {\r\n\t\tthis.diagramEngine = SRD.default();\r\n\r\n\t\tthis.diagramEngine.getNodeFactories().registerFactory(new MyEditableNodeFactory());\r\n\t\tthis.diagramEngine.getLinkFactories().registerFactory(new RightAngleLinkFactory());\r\n\t\tthis.diagramEngine.getLabelFactories().registerFactory(new EditableLabelFactory());\r\n\r\n\t\tthis.newModel();\r\n\t}\r\n\r\n\tpublic newModel() {\r\n\t\tthis.activeModel = new SRD.DiagramModel();\r\n\t\tthis.diagramEngine.setModel(this.activeModel);\r\n\t}\r\n\r\n\tpublic getActiveDiagram(): SRD.DiagramModel {\r\n\t\treturn this.activeModel;\r\n\t}\r\n\r\n\tpublic getDiagramEngine(): SRD.DiagramEngine {\r\n\t\treturn this.diagramEngine;\r\n\t}\r\n}\r\n","import * as go from 'gojs';\r\nimport { ReactDiagram } from 'gojs-react';\r\n\r\nimport './go.css';\r\nfunction initDiagram(options: any) {\r\n    // console.log('initDiagram with', options)\r\n    const $ = go.GraphObject.make;\r\n    // go.TreeLayout.ArrangementVertical :\r\n\r\n\r\n    const myDiagram = $(go.Diagram,\r\n        {\r\n            layout: $(go.TreeLayout,\r\n                { // this only lays out in trees nodes connected by \"generalization\" links\r\n                    angle: options?.isTree ? 90 : 180,\r\n                    path: go.TreeLayout.PathSource,  // links go from child to parent\r\n                    setsPortSpot: false,  // keep Spot.AllSides for link connection spot\r\n                    setsChildPortSpot: false,  // keep Spot.AllSides\r\n                    arrangement: options?.isTree ? go.TreeLayout.ArrangementHorizontal : undefined,\r\n                    nodeSpacing: 1000, layerSpacing: 1000\r\n                })\r\n        });\r\n\r\n    function convertVisibility(v: any) {\r\n        switch (v) {\r\n            case \"public\": return \"+\";\r\n            case \"private\": return \"-\";\r\n            case \"protected\": return \"#\";\r\n            case \"package\": return \"~\";\r\n            default: return v;\r\n        }\r\n    }\r\n\r\n    var propertyTemplate =\r\n        $(go.Panel, \"Horizontal\",\r\n            // property visibility/access\r\n            $(go.TextBlock,\r\n                { isMultiline: false, editable: false, width: 12 },\r\n                new go.Binding(\"text\", \"visibility\", convertVisibility)),\r\n            // property name, underlined if scope==\"class\" to indicate static property\r\n            $(go.TextBlock,\r\n                { isMultiline: false, editable: true },\r\n                new go.Binding(\"text\", \"name\").makeTwoWay(),\r\n                new go.Binding(\"isUnderline\", \"scope\", s => s[0] === 'c')),\r\n            // property type, if known\r\n            $(go.TextBlock, \"\",\r\n                new go.Binding(\"text\", \"type\", t => t ? \": \" : \"\")),\r\n            $(go.TextBlock,\r\n                { isMultiline: false, editable: true },\r\n                new go.Binding(\"text\", \"type\").makeTwoWay()),\r\n            // property default value, if any\r\n            $(go.TextBlock,\r\n                { isMultiline: false, editable: false },\r\n                new go.Binding(\"text\", \"default\", s => s ? \" = \" + s : \"\"))\r\n        );\r\n    var methodTemplate =\r\n        $(go.Panel, \"Horizontal\",\r\n            // method visibility/access\r\n            $(go.TextBlock,\r\n                { isMultiline: false, editable: false, width: 12 },\r\n                new go.Binding(\"text\", \"visibility\", convertVisibility)),\r\n            // method name, underlined if scope==\"class\" to indicate static method\r\n            $(go.TextBlock,\r\n                { isMultiline: false, editable: true },\r\n                new go.Binding(\"text\", \"name\").makeTwoWay(),\r\n                new go.Binding(\"isUnderline\", \"scope\", s => s[0] === 'c')),\r\n\r\n            $(go.TextBlock, \"\",\r\n                new go.Binding(\"text\", \"type\", t => t ? \": \" : \"\")),\r\n            $(go.TextBlock,\r\n                { isMultiline: false, editable: true },\r\n                new go.Binding(\"text\", \"type\").makeTwoWay())\r\n        );\r\n\r\n    myDiagram.nodeTemplate =\r\n        $(go.Node, \"Auto\",\r\n            {\r\n                locationSpot: go.Spot.Center,\r\n                fromSpot: go.Spot.AllSides,\r\n                toSpot: go.Spot.AllSides\r\n            },\r\n            $(go.Shape, {\r\n                fill: \"lightcyan\",\r\n                minSize: !!options?.hasMinSize ? new go.Size(100, 200) : new go.Size(10, 10),\r\n            }),\r\n            $(go.Panel, \"Table\",\r\n                { defaultRowSeparatorStroke: \"black\" },\r\n                // header\r\n                $(go.TextBlock,\r\n                    {\r\n                        row: 0, columnSpan: 2, margin: 3, alignment: go.Spot.Center,\r\n                        font: \"bold 12pt sans-serif\",\r\n                        isMultiline: false, editable: true\r\n                    },\r\n                    new go.Binding(\"text\", \"name\").makeTwoWay()),\r\n                // properties\r\n                $(go.TextBlock, \"Properties\",\r\n                    { row: 1, font: \"italic 10pt sans-serif\" },\r\n                    new go.Binding(\"visible\", \"visible\", v => !v).ofObject(\"PROPERTIES\")),\r\n                $(go.Panel, \"Vertical\", { name: \"PROPERTIES\" },\r\n                    new go.Binding(\"itemArray\", \"properties\"),\r\n                    {\r\n                        row: 1, margin: 3, stretch: go.GraphObject.Fill,\r\n                        defaultAlignment: go.Spot.Left, background: \"lightcyan\",\r\n                        itemTemplate: propertyTemplate\r\n                    }\r\n                ),\r\n                $(\"PanelExpanderButton\", \"PROPERTIES\",\r\n                    { row: 1, column: 1, alignment: go.Spot.TopRight, visible: false },\r\n                    new go.Binding(\"visible\", \"properties\", arr => arr.length > 0)),\r\n\r\n\r\n                $(go.TextBlock, \"Methods\",\r\n                    { row: 2, font: \"italic 10pt sans-serif\" },\r\n                    new go.Binding(\"visible\", \"visible\", v => !v).ofObject(\"METHODS\")),\r\n                $(go.Panel, \"Vertical\", { name: \"METHODS\" },\r\n                    new go.Binding(\"itemArray\", \"methods\"),\r\n                    {\r\n                        row: 2, margin: 3, stretch: go.GraphObject.Fill,\r\n                        defaultAlignment: go.Spot.Left, background: \"lightcyan\",\r\n                        itemTemplate: methodTemplate\r\n                    }\r\n                ),\r\n                $(\"PanelExpanderButton\", \"METHODS\",\r\n                    { row: 2, column: 1, alignment: go.Spot.TopRight, visible: false },\r\n                    new go.Binding(\"visible\", \"methods\", arr => arr.length > 0))\r\n            )\r\n        );\r\n    myDiagram.nodeTemplateMap.add(\"Start\",\r\n        $(go.Node, \"Spot\", {\r\n            locationSpot: go.Spot.Center,\r\n            fromSpot: go.Spot.AllSides,\r\n            toSpot: go.Spot.AllSides,\r\n            desiredSize: new go.Size(75, 75)\r\n        },\r\n            new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(go.Point.stringify),\r\n            $(go.Shape, \"Circle\",\r\n                {\r\n                    fill: \"#52ce60\", /* green */\r\n                    stroke: null,\r\n                }),\r\n            $(go.TextBlock, \"Start\",\r\n                {\r\n                    font: \"bold 16pt helvetica, bold arial, sans-serif\",\r\n                    stroke: \"whitesmoke\"\r\n                })\r\n        )\r\n    );\r\n\r\n    myDiagram.nodeTemplateMap.add(\"End\",\r\n        $(go.Node, \"Spot\", { desiredSize: new go.Size(75, 75) },\r\n            new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(go.Point.stringify),\r\n            $(go.Shape, \"Circle\",\r\n                {\r\n                    fill: \"maroon\",\r\n                    stroke: null,\r\n                }),\r\n            $(go.Shape, \"Circle\", { fill: null, desiredSize: new go.Size(65, 65), strokeWidth: 2, stroke: \"whitesmoke\" }),\r\n            $(go.TextBlock, \"End\",\r\n                {\r\n                    font: \"bold 16pt helvetica, bold arial, sans-serif\",\r\n                    stroke: \"whitesmoke\"\r\n                })\r\n        )\r\n    );\r\n    function convertIsTreeLink(r: string) {\r\n        return r === \"generalization\";\r\n    }\r\n    function convertIsStateLink(r: string) {\r\n        return r === \"state\";\r\n    }\r\n\r\n    function convertFromArrow(r: any) {\r\n        switch (r) {\r\n            case \"generalization\": return \"\";\r\n            default: return \"\";\r\n        }\r\n    }\r\n\r\n    function convertToArrow(r: any) {\r\n        switch (r) {\r\n            case \"generalization\": return \"Triangle\";\r\n            case \"state\": return \"Triangle\";\r\n            case \"aggregation\": return \"StretchedDiamond\";\r\n            default: return \"\";\r\n        }\r\n    }\r\n\r\n    myDiagram.linkTemplate =\r\n        $(go.Link,\r\n            { routing: go.Link.Orthogonal },\r\n            new go.Binding(\"isLayoutPositioned\", \"relationship\", convertIsTreeLink),\r\n            new go.Binding(\"isLayoutPositioned\", \"relationship\", convertIsStateLink),\r\n            $(go.Shape),\r\n            $(go.Shape, { scale: 1.3, fill: \"white\" },\r\n                new go.Binding(\"fromArrow\", \"relationship\", convertFromArrow)),\r\n            $(go.Shape, { scale: 1.3, fill: \"white\" },\r\n                new go.Binding(\"toArrow\", \"relationship\", convertToArrow)),\r\n            $(go.TextBlock, \"\",\r\n                {\r\n                    textAlign: \"center\",\r\n                    font: \"12pt helvetica, arial, sans-serif\",\r\n                    margin: 4,\r\n                    editable: false\r\n                },\r\n                new go.Binding(\"text\").makeTwoWay()),\r\n        );\r\n\r\n    myDiagram.model = new go.GraphLinksModel(\r\n        {\r\n            linkKeyProperty: 'key',\r\n            copiesArrays: true,\r\n            copiesArrayObjects: true,\r\n        });\r\n\r\n    return myDiagram;\r\n}\r\n\r\nexport default function GoClass(props: { nodedata: any, linkdata: any, diagramOptions?: any }) {\r\n    return (\r\n        <ReactDiagram\r\n            initDiagram={() => initDiagram(props.diagramOptions)}\r\n            divClassName='diagram-component'\r\n            nodeDataArray={props.nodedata}\r\n            linkDataArray={props.linkdata}\r\n        />\r\n    );\r\n}","// const startDelta = 1000\r\n// const endDelta = 2000\r\nconst controllerDelta = 3000\r\nconst methodDelta = 4000\r\n\r\nexport function getGoProperties(node: any) {\r\n    let properties: any[] = []\r\n    for (const [key, value] of Object.entries(node.extras)) {\r\n        // if (!['selectableOptions'].includes(key))\r\n        properties.push({ name: `${key}: ${value}`, visibility: 'private' })\r\n    }\r\n    return properties\r\n}\r\n\r\nexport function getGoMethods(node: any) {\r\n    let methods: any[] = []\r\n    node.ports?.forEach((method: any) => {\r\n        methods.push({ name: method.label, visibility: 'public' })\r\n    });\r\n    node.methods?.forEach((method: any) => {\r\n        methods.push({ name: method, visibility: 'public' })\r\n    });\r\n    node.ins?.forEach((method: any) => {\r\n        methods.push({ name: method, visibility: 'public' })\r\n    });\r\n    node.outs?.forEach((method: any) => {\r\n        methods.push({ name: method, visibility: 'public' })\r\n    });\r\n    return methods\r\n}\r\nexport function processDynamic(node: any, index: number, hasSupportNodes = true, badMethod: any = null) {\r\n    let nodes: any[] = []\r\n    let links: any[] = []\r\n\r\n    nodes.push({ key: index + controllerDelta, name: 'MicroController' })\r\n    nodes.push({\r\n        key: index,\r\n        name: node.name,\r\n    })\r\n    if (badMethod) {\r\n        links.push({\r\n            key: index + methodDelta,\r\n            from: index + controllerDelta,\r\n            to: index, text: badMethod.name,\r\n            relationship: \"state\"\r\n        })\r\n    } else {\r\n        getGoMethods(node).forEach((method, methodIndex) => {\r\n            links.push({\r\n                key: index + (methodIndex + 1) * methodDelta,\r\n                from: index + controllerDelta,\r\n                to: index, text: method.name,\r\n                relationship: \"state\"\r\n            })\r\n        });\r\n    }\r\n\r\n    // if (hasSupportNodes) {\r\n    //     nodes.push({ key: index + startDelta, category: \"Start\" })\r\n    //     links.push({\r\n    //         key: index + controllerDelta,\r\n    //         from: index + startDelta,\r\n    //         to: index + controllerDelta,\r\n    //         relationship: \"state\"\r\n    //     })\r\n    //     nodes.push({ key: index + endDelta, category: \"End\" })\r\n    //     links.push({\r\n    //         key: index + endDelta,\r\n    //         from: index,\r\n    //         to: index + endDelta,\r\n    //         relationship: \"state\"\r\n    //     })\r\n    // }\r\n\r\n    return { nodes, links }\r\n}","/* eslint-disable jsx-a11y/anchor-is-valid */\r\nimport * as React from 'react';\r\nimport styled from '@emotion/styled';\r\nimport OpenInNewIcon from '@mui/icons-material/OpenInNew';\r\nimport ReactTooltip from 'react-tooltip';\r\nimport GoClass from '../GoClass';\r\nimport { getGoMethods, getGoProperties } from '../goBuilder';\r\n\r\nexport interface TrayItemWidgetProps {\r\n\tnode: any;\r\n}\r\n\r\nnamespace S {\r\n\texport const Tray = styled.div<{ color: string }>`\r\n\t\tcolor: white;\r\n\t\tfont-family: Helvetica, Arial;\r\n\t\tfont-size:0.6em;\r\n\t\tpadding: 2px 0px;\r\n\t\tmargin:\t 5px 10px ;\r\n\t\tborder: solid 2px ${(p) => p.color};\r\n\t\tborder-radius: 100px;\r\n\t\tmargin-bottom: 2px;\r\n\t\tcursor: pointer;\r\n\t\tbackground: rgb(20, 20, 20);\r\n\t`;\r\n}\r\n\r\nexport class TrayItemWidget extends React.Component<TrayItemWidgetProps> {\r\n\trender() {\r\n\t\tconst node = {\r\n\t\t\tkey: 0,\r\n\t\t\tname: this.props.node.name,\r\n\t\t\tproperties: getGoProperties(this.props.node),\r\n\t\t\tmethods: getGoMethods(this.props.node),\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<S.Tray\r\n\t\t\t\tcolor={this.props.node.highlighted ? this.props.node.color || 'grey' : 'grey'}\r\n\t\t\t\tdraggable={true}\r\n\t\t\t\tonDragStart={(event) => {\r\n\t\t\t\t\tevent.dataTransfer.setData('storm-diagram-node', JSON.stringify(this.props.node));\r\n\t\t\t\t\tevent.dataTransfer.setDragImage(new Image(), 10, 10);\r\n\t\t\t\t}}\r\n\t\t\t\tclassName=\"tray-item\"\r\n\t\t\t>\r\n\r\n\t\t\t\t{this.props.node.name}\r\n\r\n\t\t\t\t<a data-tip data-for={'tip-' + this.props.node.name} style={{ float: 'right', marginRight: '6px' }} >\r\n\t\t\t\t\t<OpenInNewIcon style={{ fontSize: '1rem' }} />\r\n\t\t\t\t</a>\r\n\t\t\t\t<ReactTooltip\r\n\t\t\t\t\tclassName=\"interactableTooltip\"\r\n\t\t\t\t\tid={'tip-' + this.props.node.name}\r\n\t\t\t\t\ttype='light' place=\"right\"\r\n\t\t\t\t\tdelayHide={500}\r\n\t\t\t\t\teffect=\"solid\"\r\n\t\t\t\t>\r\n\t\t\t\t\t{this.props.node.extras.description ?\r\n\t\t\t\t\t\t<div className='miniGoAndDescriptionHolder'>\r\n\t\t\t\t\t\t\t<div className='separator'>\r\n\r\n\t\t\t\t\t\t\t\t<GoClass linkdata={[]} nodedata={[node]}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t<div className='linkHolder'>\r\n\t\t\t\t\t\t\t\t\t<a href={this.props.node.extras.link} target=\"_blank\" rel=\"noopener noreferrer\">Documentation</a>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className='descriptionHolder'>\r\n\t\t\t\t\t\t\t\t{this.props.node.extras.description}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t: <div className='miniGoHolder'>\r\n\t\t\t\t\t\t\t<GoClass\r\n\t\t\t\t\t\t\t\tlinkdata={[]} nodedata={[node]} />\r\n\t\t\t\t\t\t</div>}\r\n\t\t\t\t</ReactTooltip>\r\n\t\t\t</S.Tray>\r\n\t\t);\r\n\t}\r\n}\r\n","import * as React from 'react';\r\nimport styled from '@emotion/styled';\r\nimport { css, Global } from '@emotion/react';\r\n\r\nexport interface MyCanvasWidgetProps {\r\n\tcolor?: string;\r\n\tbackground?: string;\r\n}\r\n\r\nnamespace S {\r\n\texport const Container = styled.div<{ color: string; background: string }>`\r\n\t\theight: 100%;\r\n\t\tbackground-color: ${(p) => p.background};\r\n\t\tbackground-size: 50px 50px;\r\n\t\tdisplay: flex;\r\n\r\n\t\t> * {\r\n\t\t\theight: 100%;\r\n\t\t\tmin-height: 100%;\r\n\t\t\twidth: 100%;\r\n\t\t}\r\n\r\n\t\tbackground-image: linear-gradient(\r\n\t\t\t\t0deg,\r\n\t\t\t\ttransparent 24%,\r\n\t\t\t\t${(p) => p.color} 25%,\r\n\t\t\t\t${(p) => p.color} 26%,\r\n\t\t\t\ttransparent 27%,\r\n\t\t\t\ttransparent 74%,\r\n\t\t\t\t${(p) => p.color} 75%,\r\n\t\t\t\t${(p) => p.color} 76%,\r\n\t\t\t\ttransparent 77%,\r\n\t\t\t\ttransparent\r\n\t\t\t),\r\n\t\t\tlinear-gradient(\r\n\t\t\t\t90deg,\r\n\t\t\t\ttransparent 24%,\r\n\t\t\t\t${(p) => p.color} 25%,\r\n\t\t\t\t${(p) => p.color} 26%,\r\n\t\t\t\ttransparent 27%,\r\n\t\t\t\ttransparent 74%,\r\n\t\t\t\t${(p) => p.color} 75%,\r\n\t\t\t\t${(p) => p.color} 76%,\r\n\t\t\t\ttransparent 77%,\r\n\t\t\t\ttransparent\r\n\t\t\t);\r\n\t`;\r\n\r\n\texport const Expand = css`\r\n\t\thtml,\r\n\t\tbody,\r\n\t\t#root {\r\n\t\t\theight: 100%;\r\n\t\t}\r\n\t`;\r\n}\r\n\r\nexport class MyCanvasWidget extends React.Component<MyCanvasWidgetProps> {\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<Global styles={S.Expand} />\r\n\t\t\t\t<S.Container\r\n\t\t\t\t\tbackground={this.props.background || 'rgb(60, 60, 60)'}\r\n\t\t\t\t\tcolor={this.props.color || 'rgba(255,255,255, 0.05)'}>\r\n\t\t\t\t\t{this.props.children}\r\n\t\t\t\t</S.Container>\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n}\r\n","import { DefaultLinkModel, DefaultLinkModelOptions } from '@projectstorm/react-diagrams-defaults';\r\nimport { PointModel } from '@projectstorm/react-diagrams-core';\r\nimport { DeserializeEvent } from '@projectstorm/react-canvas-core';\r\nimport { RightAngleLinkFactory } from '@projectstorm/react-diagrams';\r\n\r\nexport class MyRightAngleLinkModel extends DefaultLinkModel {\r\n\tlastHoverIndexOfPath: number;\r\n\tprivate _lastPathXdirection: boolean;\r\n\tprivate _firstPathXdirection: boolean;\r\n\tconstructor(options: DefaultLinkModelOptions = {}) {\r\n\t\tsuper({\r\n\t\t\ttype: RightAngleLinkFactory.NAME,\r\n\t\t\t...options\r\n\t\t});\r\n\t\tthis.lastHoverIndexOfPath = 0;\r\n\t\tthis._lastPathXdirection = false;\r\n\t\tthis._firstPathXdirection = false;\r\n\t}\r\n\r\n\tsetFirstAndLastPathsDirection() {\r\n\t\tlet points = this.getPoints();\r\n\t\tfor (let i = 1; i < points.length; i += points.length - 2) {\r\n\t\t\tlet dx = Math.abs(points[i].getX() - points[i - 1].getX());\r\n\t\t\tlet dy = Math.abs(points[i].getY() - points[i - 1].getY());\r\n\t\t\tif (i - 1 === 0) {\r\n\t\t\t\tthis._firstPathXdirection = dx > dy;\r\n\t\t\t} else {\r\n\t\t\t\tthis._lastPathXdirection = dx > dy;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// @ts-ignore\r\n\taddPoint<P extends PointModel>(pointModel: P, index: number = 1): P {\r\n\t\t// @ts-ignore\r\n\t\tsuper.addPoint(pointModel, index);\r\n\t\tthis.setFirstAndLastPathsDirection();\r\n\t\treturn pointModel;\r\n\t}\r\n\r\n\tdeserialize(event: DeserializeEvent<this>) {\r\n\t\tsuper.deserialize(event);\r\n\t\tthis.setFirstAndLastPathsDirection();\r\n\t}\r\n\r\n\tsetManuallyFirstAndLastPathsDirection(first: boolean, last: boolean) {\r\n\t\tthis._firstPathXdirection = first;\r\n\t\tthis._lastPathXdirection = last;\r\n\t}\r\n\r\n\tgetLastPathXdirection(): boolean {\r\n\t\treturn this._lastPathXdirection;\r\n\t}\r\n\tgetFirstPathXdirection(): boolean {\r\n\t\treturn this._firstPathXdirection;\r\n\t}\r\n\r\n\tsetWidth(width: number) {\r\n\t\tthis.options.width = width;\r\n\t\tthis.fireEvent({ width }, 'widthChanged');\r\n\t}\r\n\r\n\tsetColor(color: string) {\r\n\t\tthis.options.color = color;\r\n\t\tthis.fireEvent({ color }, 'colorChanged');\r\n\t}\r\n}","import {\r\n\tPortModel,\r\n\tPortModelAlignment,\r\n\tPortModelGenerics,\r\n\tPortModelOptions\r\n} from '@projectstorm/react-diagrams-core';\r\nimport { MyRightAngleLinkModel } from './MyRightAngleLinkModel';\r\nimport { DeserializeEvent } from '@projectstorm/react-canvas-core';\r\nimport { EditableLabelModel } from '../custom-link-label/EditableLabelModel';\r\n\r\nexport interface MyPortModelOptions extends PortModelOptions {\r\n\tlabel?: string;\r\n\tin?: boolean;\r\n\thasHiddenLabel?: boolean;\r\n}\r\n\r\nexport interface DefaultPortModelGenerics extends PortModelGenerics {\r\n\tOPTIONS: MyPortModelOptions;\r\n}\r\n\r\nexport class MyPortModel extends PortModel<DefaultPortModelGenerics> {\r\n\textras: any;\r\n\tconstructor(options: MyPortModelOptions) {\r\n\t\tsuper({\r\n\t\t\tin: options.in,\r\n\t\t\tname: options.name,\r\n\t\t\tlabel: options.label || options.name,\r\n\t\t\talignment: options.in ? PortModelAlignment.LEFT : PortModelAlignment.RIGHT,\r\n\t\t\ttype: 'default',\r\n\t\t\textras: { hasHiddenLabel: options.hasHiddenLabel }\r\n\t\t});\r\n\t}\r\n\r\n\tdeserialize(event: DeserializeEvent<this>) {\r\n\t\tsuper.deserialize(event);\r\n\t\tthis.options.extras = event.data.extras;\r\n\t\tthis.options.in = event.data.in;\r\n\t\tthis.options.label = event.data.label;\r\n\t}\r\n\r\n\tserialize() {\r\n\t\treturn {\r\n\t\t\t...super.serialize(),\r\n\t\t\tin: this.options.in,\r\n\t\t\tlabel: this.options.label,\r\n\t\t\textras: this.options.extras,\r\n\t\t};\r\n\t}\r\n\r\n\tcanLinkToPort(port: PortModel): boolean {\r\n\t\t// console.log('checking if can link', port)\r\n\t\treturn port.getOptions().id !== this.getOptions().id\r\n\t}\r\n\tcreateLinkModel(): MyRightAngleLinkModel {\r\n\t\tfunction genColor(seed: any) {\r\n\t\t\tlet color: any = Math.floor((Math.abs(Math.sin(seed) * 16777215)));\r\n\t\t\tcolor = color.toString(16);\r\n\t\t\t// pad any colors shorter than 6 characters with leading 0s\r\n\t\t\twhile (color.length < 6) {\r\n\t\t\t\tcolor = '0' + color;\r\n\t\t\t}\r\n\t\t\tconsole.log('generated color', color, 'with seed', seed)\r\n\t\t\treturn color;\r\n\t\t}\r\n\r\n\t\tlet link = new MyRightAngleLinkModel()\r\n\r\n\r\n\t\t// console.log('creating link model')\r\n\t\t// link.getOptions().testName = 'Test';\r\n\t\t// link.addLabel(\r\n\t\t// \tnew EditableLabelModel({\r\n\t\t// \t\tvalue: 'Hello, I am label!'\r\n\t\t// \t})\r\n\t\t// );\r\n\t\tlink.setWidth(5)\r\n\r\n\t\tsetTimeout(() => {\r\n\t\t\ttry {\r\n\t\t\t\tconst ports = Object.values(link.getSourcePort().getParent().getPorts())\r\n\t\t\t\tconst linkQuantity = Object.values(ports).map(port => Object.keys(port.links).length)\r\n\t\t\t\t\t.reduce((acc: any, l: any) => { return acc + l }, 0)\r\n\r\n\t\t\t\tif (linkQuantity) {\r\n\t\t\t\t\tlink.setColor('#' + genColor(3 + linkQuantity))\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthrow (new Error('no links'))\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tlink.setColor('#f42921')\r\n\r\n\t\t\t}\r\n\r\n\t\t}, 500);\r\n\r\n\t\treturn link\r\n\t}\r\n}\r\n","import * as _ from 'lodash';\r\nimport { NodeModel, NodeModelGenerics, PortModelAlignment } from '@projectstorm/react-diagrams-core';\r\nimport { BasePositionModelOptions, DeserializeEvent } from '@projectstorm/react-canvas-core';\r\nimport { MyPortModel } from '../myNode/MyPortModel';\r\n\r\nexport interface DefaultNodeModelOptions extends BasePositionModelOptions {\r\n    name?: string;\r\n    color?: string;\r\n}\r\n\r\nexport interface DefaultNodeModelGenerics extends NodeModelGenerics {\r\n    OPTIONS: DefaultNodeModelOptions;\r\n}\r\n\r\nexport class MyEditableNodeModel extends NodeModel<DefaultNodeModelGenerics> {\r\n    portsIn: MyPortModel[] = [];\r\n    portsOut: MyPortModel[] = [];\r\n    extras: Object;\r\n    selectableOptions: string[];\r\n    constructor(data: any) {\r\n        super({\r\n            type: 'MyEditable',\r\n            name: data.name,\r\n            color: data.color,\r\n        });\r\n\r\n        data.extras.returnType = data.extras.returnType || 'byte'\r\n        data.extras.value = data.extras.value || 'value'\r\n\r\n        this.extras = data.extras;\r\n\r\n        data.methods?.forEach((biPort: string) => {\r\n            this.addInPort(biPort)\r\n            this.addOutPort(biPort + ' ', true, true)\r\n        });\r\n        data.ins?.forEach((inPort: string) => {\r\n            this.addInPort(inPort)\r\n        });\r\n        data.outs?.forEach((outPort: string) => {\r\n            this.addOutPort(outPort)\r\n        });\r\n        this.selectableOptions = data.extras.selectableOptions || false;\r\n    }\r\n\r\n    doClone(lookupTable: {}, clone: any): void {\r\n        clone.portsIn = [];\r\n        clone.portsOut = [];\r\n        super.doClone(lookupTable, clone);\r\n    }\r\n\r\n    removePort(port: MyPortModel): void {\r\n        super.removePort(port);\r\n        if (port.getOptions().in) {\r\n            this.portsIn.splice(this.portsIn.indexOf(port), 1);\r\n        } else {\r\n            this.portsOut.splice(this.portsOut.indexOf(port), 1);\r\n        }\r\n    }\r\n    //todo add changeport?\r\n    addPort<T extends MyPortModel>(port: T): T {\r\n        super.addPort(port);\r\n        if (port.getOptions().in) {\r\n            if (this.portsIn.indexOf(port) === -1) {\r\n                this.portsIn.push(port);\r\n            }\r\n        } else {\r\n            if (this.portsOut.indexOf(port) === -1) {\r\n                this.portsOut.push(port);\r\n            }\r\n        }\r\n        return port;\r\n    }\r\n\r\n    addInPort(name: string, after = true): MyPortModel {\r\n        const p = new MyPortModel({\r\n            in: true,\r\n            name: name,\r\n            label: name,\r\n            alignment: PortModelAlignment.LEFT,\r\n            hasHiddenLabel: false\r\n        });\r\n        if (!after) {\r\n            this.portsIn.splice(0, 0, p);\r\n        }\r\n        return this.addPort(p);\r\n    }\r\n\r\n\r\n    renamePort(oldName: string, newName: string): void {\r\n        const portInIndex = this.portsIn.findIndex(p => p.getOptions().name === oldName)\r\n\r\n        this.portsIn[portInIndex].getOptions().name = newName\r\n        this.portsIn[portInIndex].getOptions().label = newName\r\n\r\n        this.ports[newName] = this.ports[oldName];\r\n        delete this.ports[oldName];\r\n    }\r\n\r\n\r\n\r\n\r\n    addOutPort(name: string, after = true, hasHiddenLabel = false): MyPortModel {\r\n        const p = new MyPortModel({\r\n            in: false,\r\n            name: name,\r\n            label: hasHiddenLabel ? name + ' ' : name,\r\n            alignment: PortModelAlignment.RIGHT,\r\n            hasHiddenLabel: hasHiddenLabel\r\n        });\r\n        if (!after) {\r\n            this.portsOut.splice(0, 0, p);\r\n        }\r\n        return this.addPort(p);\r\n    }\r\n\r\n    addExtras(extras: any): any {\r\n        this.extras = extras;\r\n        return this.extras\r\n    }\r\n\r\n    deserialize(event: DeserializeEvent<this>) {\r\n        super.deserialize(event);\r\n        this.options.name = event.data.name;\r\n        this.options.color = event.data.color;\r\n        this.portsIn = _.map(event.data.portsInOrder, (id) => {\r\n            return this.getPortFromID(id);\r\n        }) as MyPortModel[];\r\n        this.portsOut = _.map(event.data.portsOutOrder, (id) => {\r\n            return this.getPortFromID(id);\r\n        }) as MyPortModel[];\r\n        this.extras = event.data.extras\r\n        this.selectableOptions = event.data.selectableOptions\r\n    }\r\n\r\n    serialize(): any {\r\n        return {\r\n            ...super.serialize(),\r\n            name: this.options.name,\r\n            color: this.options.color,\r\n            portsInOrder: _.map(this.portsIn, (port) => {\r\n                return port.getID();\r\n            }),\r\n            portsOutOrder: _.map(this.portsOut, (port) => {\r\n                return port.getID();\r\n            }),\r\n            extras: this.extras,\r\n            selectableOptions: this.selectableOptions\r\n        }\r\n    }\r\n\r\n    getInPorts(): MyPortModel[] {\r\n        return this.portsIn;\r\n    }\r\n\r\n    getOutPorts(): MyPortModel[] {\r\n        return this.portsOut;\r\n    }\r\n}","/* eslint-disable */\r\nexport default [\r\n    {\r\n        name: 'Arduino Uno',\r\n        color: 'green',\r\n        highlighted: true,\r\n        extras: {\r\n            type: 'controller',\r\n            analogPorts: 6,\r\n            digitalPorts: 14,\r\n        },\r\n        outs: [\r\n            'setup()',\r\n            'loop()',\r\n        ]\r\n    }, {\r\n        name: 'Arduino Nano',\r\n        color: 'green',\r\n        extras: {\r\n            type: 'controller',\r\n            analogPorts: 6,\r\n            digitalPorts: 22,\r\n        },\r\n        outs: [\r\n            'setup()',\r\n            'loop()'\r\n        ]\r\n    },\r\n    {\r\n        name: 'Arduino Mega',\r\n        color: 'green',\r\n        extras: {\r\n            type: 'controller',\r\n            analogPorts: 16,\r\n            digitalPorts: 54,\r\n        },\r\n        outs: [\r\n            'setup()',\r\n            'loop()'\r\n        ]\r\n    },\r\n    {\r\n        name: 'Arduino Leonardo',\r\n        color: 'green',\r\n        extras: {\r\n            type: 'controller',\r\n            analogPorts: 12,\r\n            digitalPorts: 20,\r\n        },\r\n        outs: [\r\n            'setup()',\r\n            'loop()'\r\n        ]\r\n    },\r\n    {\r\n        name: 'Arduino Flora',\r\n        color: 'green',\r\n        extras: {\r\n            type: 'controller',\r\n            analogPorts: 4,\r\n            digitalPorts: 8,\r\n        },\r\n        outs: [\r\n            'setup()',\r\n            'loop()'\r\n        ]\r\n    },\r\n    {\r\n        name: 'Port',\r\n        color: 'pink',\r\n        extras: {\r\n            value: '0',\r\n            group: 'value',\r\n            type: 'port',\r\n            hasUsages: true,\r\n            hasPortType: true,\r\n            portType: 'Digital',\r\n            returnType: 'int',\r\n            selectableOptions: Array.from(Array(100).keys()).map(x => x.toString()),\r\n            hasValue: true,\r\n        },\r\n        ins: [\r\n            'in'\r\n        ],\r\n        outs: [\r\n            'out',\r\n        ]\r\n    },\r\n    {\r\n        name: 'Parameter(s)',\r\n        color: 'pink',\r\n        highlighted: true,\r\n        extras: {\r\n            group: 'value',\r\n            type: 'parameter',\r\n            hasUsages: true,\r\n            hasReturnType: true,\r\n            value: '0',\r\n            hasValue: true,\r\n        },\r\n        ins: [\r\n            'in'\r\n        ],\r\n        outs: [\r\n            'out',\r\n        ]\r\n    },\r\n    {\r\n        name: 'Variable(s)',\r\n        color: 'pink',\r\n        extras: {\r\n            group: 'value',\r\n            type: 'variable',\r\n            name: 'var',\r\n            hasUsages: true,\r\n            hasReturnType: true,\r\n            hasUsername: true,\r\n            hasValue: true,\r\n        },\r\n        methods: ['void declaration'],\r\n        ins: [\r\n            'in',\r\n        ],\r\n        outs: [\r\n            'out',\r\n        ]\r\n    },\r\n    {\r\n        name: 'Constant(s)',\r\n        color: 'pink',\r\n        extras: {\r\n            group: 'value',\r\n            type: 'constant',\r\n            name: 'con',\r\n            hasUsages: true,\r\n            hasReturnType: true,\r\n            hasUsername: true,\r\n            hasValue: true,\r\n        },\r\n        ins: [\r\n            'in'\r\n        ],\r\n        outs: [\r\n            'out',\r\n        ]\r\n    },\r\n    {\r\n        name: 'Function',\r\n        extras: {\r\n            type: 'logic',\r\n            returnType: 'void',\r\n            value: 'foo',\r\n            hasUsages: true,\r\n            // hasReturnType: true,\r\n            hasValue: true,\r\n        },\r\n        color: 'grey',\r\n        outs: [\r\n            'body',\r\n            // 'out',\r\n        ],\r\n        ins: [\r\n            'declare',\r\n            'in',\r\n        ]\r\n    }, {\r\n        name: 'Condition',\r\n        extras: {\r\n            type: 'logic',\r\n            selectableOptions: ['==', '!=', '<', '>', '<=', '>=', '<=>'],\r\n            value: '==',\r\n            hasValue: true\r\n        },\r\n        color: 'grey',\r\n        outs: [\r\n            'body',\r\n            'else'\r\n        ],\r\n        ins: [\r\n            'void set(T xValue)',\r\n            'void set(T yValue)'\r\n        ]\r\n    },\r\n    {\r\n        name: 'While Loop',\r\n        extras: {\r\n            type: 'logic',\r\n            selectableOptions: ['==', '!=', '<', '>', '<=', '>=', '<=>'],\r\n            value: '==',\r\n            hasValue: true\r\n        },\r\n        color: 'grey',\r\n        outs: [\r\n            'body',\r\n            'else'\r\n        ],\r\n        ins: [\r\n            'startValue',\r\n            'stopValue'\r\n        ]\r\n    },\r\n    {\r\n        name: 'Digital I/O',\r\n        color: 'cyan',\r\n        highlighted: true,\r\n        extras: {\r\n            type: 'built-in'\r\n        },\r\n        methods: [\r\n            'void digitalWrite(int pin, int value)',\r\n            'void pinMode(int pin, int mode)',\r\n            'int digitalRead(int pin)',\r\n        ]\r\n    },\r\n    {\r\n        name: 'Analog I/O',\r\n        color: 'cyan',\r\n        extras: {\r\n            type: 'built-in'\r\n        },\r\n        methods: [\r\n            'void analoglWrite(int pin, int value)',\r\n            'void pinMode(int pin, int mode)',\r\n            'void analogReference(int type)',\r\n\r\n        ]\r\n    },\r\n    {\r\n        name: 'Time',\r\n        color: 'cyan',\r\n        highlighted: true,\r\n        extras: {\r\n            type: 'built-in'\r\n        },\r\n        methods: [\r\n            'void delay(int ms)',\r\n            'void delayMicroseconds(int us)',\r\n            'unsigned long micros()',\r\n            'unsigned long millis()',\r\n        ]\r\n    },\r\n    {\r\n        name: 'Math',\r\n        color: 'cyan',\r\n        extras: {\r\n            type: 'built-in'\r\n        },\r\n        methods: [\r\n            'void delay(int ms)',\r\n            'int abs(int x)',\r\n            'int constrain(int x, int a, int b)',\r\n            'int map(int value, int fromLow, int fromHigh, int toLow, int toHigh)',\r\n            'any? max(any x, any y)',\r\n            'any? min(any x, any y)',\r\n            'double pow(float base, float exponent)',\r\n            'double sq(any x)',\r\n            'double sqrt(any x)',\r\n        ]\r\n    },\r\n    {\r\n        name: 'Trigonometry',\r\n        color: 'cyan',\r\n        extras: {\r\n            type: 'built-in'\r\n        },\r\n        methods: [\r\n            'double cos(float rad)',\r\n            'double sin(float rad)',\r\n            'double tan(float rad)',\r\n        ]\r\n    },\r\n    {\r\n        name: 'Random Numbers',\r\n        color: 'cyan',\r\n        extras: {\r\n            type: 'built-in'\r\n        },\r\n        methods: [\r\n            'void randomSeed(long seed)',\r\n            'long random(? max)',\r\n            'long random(? min, ? max)',\r\n        ]\r\n    },\r\n    {\r\n        name: 'Zero, Due & MKR Family',\r\n        color: 'cyan',\r\n        extras: {\r\n            type: 'built-in'\r\n        },\r\n        methods: [\r\n            'void analogReadResolution(bits bits)',\r\n            'void analogWriteResolution(bits bits)',\r\n        ]\r\n    },\r\n    {\r\n        name: 'Advanced I/O',\r\n        color: 'cyan',\r\n        extras: {\r\n            type: 'built-in'\r\n        },\r\n        methods: [\r\n            'void noTone(int pin)',\r\n            'unsigned long pulseIn(int pin, int value)',\r\n            'unsigned long pulseIn(int pin, int value,unsigned long timeout)',\r\n            'unsigned long pulseInLong(int pin, int value)',\r\n            'unsigned long pulseInLong(int pin, int value,unsigned long timeout)',\r\n            'byte shiftIn(int dataPin, int clockPin, int bitOrder)',\r\n            'void shiftOut(int dataPin, int clockPin, int bitOrder, byte value)',\r\n            'void tone(int pin, unsigned int frequency)',\r\n            'void tone(int pin, unsigned int frequency, unsigned long duration)',\r\n        ]\r\n    },\r\n    {\r\n        name: 'Serial',\r\n        color: 'cyan',\r\n        extras: {\r\n            type: 'built-in'\r\n        },\r\n        methods: [\r\n            'int available()',\r\n            'int availableForWrite()',\r\n            'void begin(long speed)',\r\n            'void end()',\r\n            'bool find(char target)',\r\n            'bool findUntil(char target)',\r\n            'void flush()',\r\n            'float parseFloat()',\r\n            'int parseInt()',\r\n            'int peek()',\r\n            'size_t print(int val)',\r\n            'size_t println(int val)',\r\n            'int read()',\r\n            'size_t readBytes(char buffer, int length)',\r\n            'size_t readBytesUntil(char character, char buffer, int length)',\r\n            'String readString()',\r\n            'String readStringUntil()',\r\n            'void setTimeout(long time)',\r\n            'size_t write(byte val)',\r\n            'void serialEvent()'\r\n        ]\r\n    },\r\n    {\r\n        name: 'true',\r\n        color: 'cyan',\r\n        extras: {\r\n            type: 'built-in-constant',\r\n            returnType: 'int',\r\n            hasUsages: true,\r\n            link: 'https://www.arduino.cc/reference/en/language/variables/constants/constants/',\r\n            description: <div><code>true</code> is often said to be defined as 1, which is correct, but true has a wider definition. Any integer which is non-zero is true, in a Boolean sense. So -1, 2 and -200 are all defined as true, too, in a Boolean sense.</div>\r\n        },\r\n        ins: [\r\n            'in',\r\n        ],\r\n        outs: [\r\n            'out',\r\n        ]\r\n    }, {\r\n        name: 'false',\r\n        color: 'cyan',\r\n        extras: {\r\n            type: 'built-in-constant',\r\n            returnType: 'int',\r\n            hasUsages: true,\r\n            link: 'https://www.arduino.cc/reference/en/language/variables/constants/constants/',\r\n            description: <div><code>false</code> is the easier of the two to define. false is defined as 0 (zero).</div>\r\n        },\r\n        ins: [\r\n            'in',\r\n        ],\r\n        outs: [\r\n            'out',\r\n        ]\r\n    }, {\r\n        name: 'HIGH',\r\n        color: 'cyan',\r\n        highlighted: true,\r\n        extras: {\r\n            type: 'built-in-constant',\r\n            returnType: 'int',\r\n            hasUsages: true,\r\n            link: 'https://www.arduino.cc/reference/en/language/variables/constants/constants/',\r\n            description: <div>\r\n                <div>\r\n                    <p>The meaning of <code>HIGH</code> (in reference to a pin) is somewhat different depending on whether a pin is set to an <code>INPUT</code> or <code>OUTPUT</code>. When a pin is configured as an <code>INPUT</code> with <code><a>pinMode()</a></code>, and read with <code><a>digitalRead()</a></code>, the Arduino (ATmega) will report <code>HIGH</code> if:</p>\r\n                </div>\r\n                <div>\r\n                    <ul>\r\n                        <li>\r\n                            <p>a voltage greater than 3.0V is present at the pin (5V boards)</p>\r\n                        </li>\r\n                        <li>\r\n                            <p>a voltage greater than 2.0V is present at the pin (3.3V boards)</p>\r\n                        </li>\r\n                    </ul>\r\n                </div>\r\n                <div>\r\n                    <p>A pin may also be configured as an INPUT with <a><code>pinMode()</code></a>, and subsequently made HIGH with <code><a>digitalWrite()</a></code>. This will enable the internal 20K pullup resistors, which will <em>pull up</em> the input pin to a <code>HIGH</code> reading unless it is pulled <code>LOW</code> by external circuitry. This can be done alternatively by passing <code>INPUT_PULLUP</code> as argument to the <a><code>pinMode()</code></a> function, as explained in more detail in the section \"Defining Digital Pins modes: INPUT, INPUT_PULLUP, and OUTPUT\" further below.</p>\r\n                </div>\r\n                <div>\r\n                    <p>When a pin is configured to OUTPUT with <a><code>pinMode()</code></a>, and set to <code>HIGH</code> with <a><code>digitalWrite()</code></a>, the pin is at:</p>\r\n                </div>\r\n                <div>\r\n                    <ul>\r\n                        <li>\r\n                            <p>5 volts (5V boards)</p>\r\n                        </li>\r\n                        <li>\r\n                            <p>3.3 volts (3.3V boards)</p>\r\n                        </li>\r\n                    </ul>\r\n                </div>\r\n                <div>\r\n                    <p>In this state it can source current, e.g. light an LED that is connected through a series resistor to ground.</p>\r\n                </div></div>\r\n        },\r\n        ins: [\r\n            'in',\r\n        ],\r\n        outs: [\r\n            'out',\r\n        ]\r\n    }, {\r\n        name: 'LOW',\r\n        color: 'cyan',\r\n        highlighted: true,\r\n        extras: {\r\n            type: 'built-in-constant',\r\n            returnType: 'int',\r\n            hasUsages: true,\r\n            link: 'https://www.arduino.cc/reference/en/language/variables/constants/constants/',\r\n            description: <div><div>\r\n                <p>The meaning of <code>LOW</code> also has a different meaning depending on whether a pin is set to <code>INPUT</code> or <code>OUTPUT</code>. When a pin is configured as an <code>INPUT</code> with <a><code>pinMode()</code></a>, and read with <a><code>digitalRead()</code></a>, the Arduino (ATmega) will report LOW if:</p>\r\n            </div>\r\n                <div>\r\n                    <ul>\r\n                        <li>\r\n                            <p>a voltage less than 1.5V is present at the pin (5V boards)</p>\r\n                        </li>\r\n                        <li>\r\n                            <p>a voltage less than 1.0V (Approx) is present at the pin (3.3V boards)</p>\r\n                        </li>\r\n                    </ul>\r\n                </div>\r\n                <div>\r\n                    <p>When a pin is configured to <code>OUTPUT</code> with <a><code>pinMode()</code></a>, and set to <code>LOW</code> with <a><code>digitalWrite()</code></a>, the pin is at 0 volts (both 5V and 3.3V boards). In this state it can sink current, e.g. light an LED that is connected through a series resistor to +5 volts (or +3.3 volts).</p>\r\n                </div></div>\r\n        },\r\n        ins: [\r\n            'in',\r\n        ],\r\n        outs: [\r\n            'out',\r\n        ]\r\n    }, {\r\n        name: 'INPUT',\r\n        color: 'cyan',\r\n        extras: {\r\n            type: 'built-in-constant',\r\n            returnType: 'int',\r\n            hasUsages: true,\r\n            link: 'https://www.arduino.cc/reference/en/language/variables/constants/constants/',\r\n            description: <div><div>\r\n                <p>Arduino (ATmega) pins configured as <code>INPUT</code> with <a><code>pinMode()</code></a> are said to be in a <em>high-impedance</em> state. Pins configured as <code>INPUT</code> make extremely small demands on the circuit that they are sampling, equivalent to a series resistor of 100 Megohms in front of the pin. This makes them useful for reading a sensor.</p>\r\n            </div>\r\n                <div>\r\n                    <p>If you have your pin configured as an <code>INPUT</code>, and are reading a switch, when the switch is in the open state the input pin will be \"floating\", resulting in unpredictable results. In order to assure a proper reading when the switch is open, a pull-up or pull-down resistor must be used. The purpose of this resistor is to pull the pin to a known state when the switch is open. A 10 K ohm resistor is usually chosen, as it is a low enough value to reliably prevent a floating input, and at the same time a high enough value to not draw too much current when the switch is closed. See the <a>Digital Read Serial</a> tutorial for more information.</p>\r\n                </div>\r\n                <div>\r\n                    <p>If a pull-down resistor is used, the input pin will be <code>LOW</code> when the switch is open and <code>HIGH</code> when the switch is closed.</p>\r\n                </div>\r\n                <div>\r\n                    <p>If a pull-up resistor is used, the input pin will be <code>HIGH</code> when the switch is open and <code>LOW</code> when the switch is closed.</p>\r\n                </div></div>\r\n        },\r\n        ins: [\r\n            'in',\r\n        ],\r\n        outs: [\r\n            'out',\r\n        ]\r\n    }, {\r\n        name: 'INPUT_PULLUP',\r\n        color: 'cyan',\r\n        extras: {\r\n            type: 'built-in-constant',\r\n            returnType: 'int',\r\n            hasUsages: true,\r\n            link: 'https://www.arduino.cc/reference/en/language/variables/constants/constants/',\r\n            description: <div><div>\r\n                <p>The ATmega microcontroller on the Arduino has internal pull-up resistors (resistors that connect to power internally) that you can access. If you prefer to use these instead of external pull-up resistors, you can use the <code>INPUT_PULLUP</code> argument in <a><code>pinMode()</code></a>.</p>\r\n            </div>\r\n                <div>\r\n                    <p>See the <a>Input Pullup Serial</a> tutorial for an example of this in use.</p>\r\n                </div>\r\n                <div>\r\n                    <p>Pins configured as inputs with either <code>INPUT</code> or <code>INPUT_PULLUP</code> can be damaged or destroyed if they are connected to voltages below ground (negative voltages) or above the positive power rail (5V or 3V).</p>\r\n                </div></div>\r\n        },\r\n        ins: [\r\n            'in',\r\n        ],\r\n        outs: [\r\n            'out',\r\n        ]\r\n    }, {\r\n        name: 'OUTPUT',\r\n        color: 'cyan',\r\n        highlighted: true,\r\n        extras: {\r\n            type: 'built-in-constant',\r\n            returnType: 'int',\r\n            hasUsages: true,\r\n            link: 'https://www.arduino.cc/reference/en/language/variables/constants/constants/',\r\n            description: <div><div>\r\n                <p>Pins configured as <code>OUTPUT</code> with <a><code>pinMode()</code></a> are said to be in a <em>low-impedance</em> state. This means that they can provide a substantial amount of current to other circuits. ATmega pins can source (provide current) or sink (absorb current) up to 40 mA (milliamps) of current to other devices/circuits. This makes them useful for powering LEDs because LEDs typically use less than 40 mA. Loads greater than 40 mA (e.g. motors) will require a transistor or other interface circuitry.</p>\r\n            </div>\r\n                <div>\r\n                    <p>Pins configured as outputs can be damaged or destroyed if they are connected to either the ground or positive power rails.</p>\r\n                </div></div>\r\n        },\r\n        ins: [\r\n            'in',\r\n        ],\r\n        outs: [\r\n            'out',\r\n        ]\r\n    }, {\r\n        name: 'LED_BUILTIN',\r\n        color: 'cyan',\r\n        highlighted: true,\r\n        extras: {\r\n            type: 'built-in-constant',\r\n            returnType: 'int',\r\n            hasUsages: true,\r\n            link: 'https://www.arduino.cc/reference/en/language/variables/constants/constants/',\r\n            description: <div>\r\n                Most Arduino boards have a pin connected to an on-board LED in series with a resistor. The constant <code>LED_BUILTIN</code> is the number of the pin to which the on-board LED is connected. Most boards have this LED connected to digital pin 13.</div>\r\n        },\r\n        ins: [\r\n            'in',\r\n        ],\r\n        outs: [\r\n            'out',\r\n        ]\r\n    },\r\n    {\r\n        name: 'TwoWire Interface',\r\n        color: 'blue',\r\n        extras: {\r\n            type: 'component',\r\n            library: 'Wire.h'\r\n        },\r\n        methods: [\r\n            'void begin()',\r\n            'void beginTransmission()',\r\n            'void setClock()',\r\n            'void onReceive()',\r\n            'void onRequest()',\r\n            'byte requestFrom()',\r\n            'byte endTransmission()',\r\n            'byte write()',\r\n            'byte available()',\r\n            'byte read()'\r\n        ]\r\n    },\r\n    {\r\n        name: 'PWM Servo',\r\n        color: 'orange',\r\n        extras: {\r\n            type: 'component',\r\n            library: 'Adafruit_PWMServoDriver.h'\r\n        },\r\n        methods: [\r\n            'void begin(uint8_t prescale=0)',\r\n            'void sleep()',\r\n            'void wakeup()',\r\n            'void setExtClk(uint8_t prescale)',\r\n            'void setPWMFreq(float freq)',\r\n            'void setOutputMode(bool totempole)',\r\n            'void setPWM(uint8_t num, uint16_t on, uint16_t off)',\r\n            'void setPin(uint8_t num, uint16_t val, bool invert=false)',\r\n            'void writeMicroseconds(uint8_t num, uint16_t Microseconds)',\r\n            'void setOscillatorFrequency(uint32_t freq)',\r\n            'uint8_t getPWM(uint8_t num)',\r\n            'uint8_t readPrescale()',\r\n            'uint32_t getOscillatorFrequency()',\r\n        ]\r\n    },\r\n    {\r\n        name: 'Servo',\r\n        color: 'orange',\r\n        extras: {\r\n            type: 'component',\r\n            library: 'Servo.h',\r\n            link: 'arduino.cc/reference/en/libraries/servo/'\r\n        },\r\n        methods: [\r\n            'uint8_t attach(int pin)',\r\n            'uint8_t attach(int pin, int min, int max)',\r\n            'void detach()',\r\n            'void write(int value)',\r\n            'void writeMicroseconds(int value)',\r\n            'int read()',\r\n            'int readMicroseconds()',\r\n            'bool attached()',\r\n        ]\r\n    },\r\n    {\r\n        name: 'Stepper',\r\n        color: 'orange',\r\n        extras: {\r\n            type: 'component',\r\n            library: 'Stepper.h'\r\n        },\r\n        methods: [\r\n            'Stepper(int, int, int)',\r\n            'Stepper(int, int, int, int, int)',\r\n            'Stepper(int, int, int, int, int, int)',\r\n            'void setSpeed(long whatSpeed)',\r\n            'void step(int number_of_steps)',\r\n            'int version()',\r\n        ]\r\n    },\r\n    {\r\n        name: 'Adafruit_BMP085',\r\n        color: 'orange',\r\n        extras: {\r\n            type: 'component',\r\n            library: 'Adafruit_BMP085.h',\r\n            link: 'https://randomnerdtutorials.com/guide-for-bmp180-barometric-sensor-with-arduino/',\r\n            description: 'Barometric pressure and temperature sensor, by Adafruit'\r\n        },\r\n        methods: [\r\n            'bool begin(uint8_t mode = BMP085_ULTRAHIGHRES, TwoWire *wire = &Wire)',\r\n            'float readTemperature()',\r\n            'int32_t readPressure',\r\n            'int32_t readSealevelPressure(float altitude_meters = 0)',\r\n            'float readAltitude(float sealevelPressure = 101325)',\r\n            'int16_t readRawTemperature()',\r\n            'uint32_t readRawPressure()',\r\n        ]\r\n    },\r\n\r\n\r\n    {\r\n        name: 'SoftwareWire',\r\n        color: 'orange',\r\n        extras: {\r\n            type: 'component',\r\n            library: 'Wire.h',\r\n            link: 'https://www.arduino.cc/reference/en/libraries/softwarewire/',\r\n            description: 'Creates a software I2C/TWI bus on every pins.'\r\n        },\r\n        methods: [\r\n            'SoftwareWire(uint8_t sdaPin, uint8_t sclPin, boolean pullups = true, boolean detectClockStretch = true)',\r\n            'void end()',\r\n            'void begin()',\r\n            'void setClock(uint32_t clock)',\r\n            'void beginTransmission(uint8_t address)',\r\n            'void beginTransmission(int address)',\r\n            'uint8_t endTransmission(boolean sendStop = true)',\r\n            'uint8_t requestFrom(uint8_t address, uint8_t size, boolean sendStop = true)',\r\n            'uint8_t requestFrom(int address, int size, boolean sendStop = true)',\r\n            'size_t write(uint8_t data)',\r\n            'size_t write(const uint8_t *data, size_t quantity)',\r\n            'int available(void)',\r\n            'int read(void)',\r\n            'int readBytes(uint8_t* buf, uint8_t size)',\r\n            'int readBytes(char * buf, uint8_t size)',\r\n            'int readBytes(char * buf, int size)',\r\n            'int peek(void)',\r\n            'void setTimeout(long timeout)',\r\n            'void printStatus(Print& Ser)'\r\n        ]\r\n    },\r\n\r\n\r\n\r\n]","/* eslint-disable jsx-a11y/anchor-is-valid */\r\nimport Prism from \"prismjs\";\r\nimport { Fragment, useEffect } from \"react\";\r\nimport \"./prism.css\";\r\n// import PrismEdit from \"./PrismEdit\";\r\nimport Xarrow from \"react-xarrows\";\r\n\r\nimport OpenInNewIcon from \"@mui/icons-material/OpenInNew\";\r\nimport ReactTooltip from \"react-tooltip\";\r\nimport GoClass from \"./GoClass\";\r\n\r\nimport { processDynamic } from \"../components/goBuilder\";\r\n\r\nconst returnTypes = [\r\n  \"byte\",\r\n  \"unsigned int\",\r\n  \"unsigned long\",\r\n  \"int\",\r\n  \"long\",\r\n  \"bool\",\r\n  \"float\",\r\n  \"double\",\r\n  \"char\",\r\n];\r\nconst ordinals = [\r\n  \"first\",\r\n  \"second\",\r\n  \"third\",\r\n  \"fourth\",\r\n  \"fifth\",\r\n  \"sixth\",\r\n  \"seventh\",\r\n  \"eighth\",\r\n  \"ninth\",\r\n  \"tenth\",\r\n  \"eleventh\",\r\n];\r\n\r\nconst paramTypes = [\r\n  \"variable\",\r\n  \"constant\",\r\n  \"parameter\",\r\n  \"port\",\r\n  \"built-in-constant\",\r\n];\r\n\r\nfunction generateCode(model: any): { code: string; problems: any[] } {\r\n  // #region Reviewed Functions\r\n  function addConstantDeclarations(constants: any) {\r\n    if (constants.length > 0) {\r\n      add(\"\");\r\n      add(\"// Constants\");\r\n      constants.forEach((constant: any) => {\r\n        let params = constant.extras.value.split(\",\");\r\n        const isArray = params.length > 1;\r\n        const count = isArray ? \"[\" + params.length + \"]\" : \"\";\r\n        params = isArray ? \"{\" + params.map((x: any) => x) + \"}\" : params;\r\n        add(\r\n          `#define ${constant.extras.returnType} ${constant.extras.name}${count} = ${params};`\r\n        );\r\n      });\r\n    }\r\n  }\r\n  function addVariableDeclarations(variables: any) {\r\n    if (variables.length > 0) {\r\n      add(\"\");\r\n      add(\"// Variables\");\r\n      variables.forEach((variable: any) => {\r\n        let params = variable.extras.value.split(\",\");\r\n        const isArray = params.length > 1;\r\n        const count = isArray ? \"[\" + params.length + \"]\" : \"\";\r\n        params = isArray ? \"{\" + params.map((x: any) => x) + \"}\" : params;\r\n\r\n        const equals = params[0] !== \"\" ? \"=\" : \"\";\r\n        add(\r\n          `${variable.extras.returnType} ${variable.extras.name}${count} ${equals} ${params}; `\r\n        );\r\n      });\r\n    }\r\n  }\r\n  function addFunctionDeclarations(functions: any) {\r\n    if (functions.length > 0) {\r\n      add(\"// Functions\");\r\n      functions.forEach((logic: any) => {\r\n        if (getPort(logic.id, logic.portsInOrder[0]).links.length === 0) {\r\n          declareFunction(logic);\r\n        }\r\n      });\r\n    }\r\n  }\r\n  function declareFunction(logic: any) {\r\n    add(`${logic.extras.returnType} ${logic.extras.value}(){`);\r\n    const callPort = logic.ports.find((x: any) => x.alignment === \"right\");\r\n    callPort.links.forEach((l: any) => {\r\n      processLink(l);\r\n    });\r\n    add(\"}\");\r\n  }\r\n\r\n  function addLibraries() {\r\n    const libraries: any[] = [\r\n      ...new Set(components.map((component) => component.extras.library)),\r\n    ];\r\n\r\n    if (libraries.length > 0) {\r\n      add(\"\");\r\n      add(\"// Libraries\");\r\n      libraries.forEach((lib: any) => {\r\n        add(\"#include <\" + lib + \">\");\r\n      });\r\n      add(\"\");\r\n      add(\"// Objects\");\r\n      libraries.forEach((lib: any) => {\r\n        components.forEach((comp) => {\r\n          if (comp.extras.library === lib) add(comp.name + \" \" + comp.instance);\r\n        });\r\n      });\r\n    }\r\n  }\r\n  function formattedParameters(params: any) {\r\n    return params.map((par: any) => {\r\n      switch (par.extras.type) {\r\n        case \"parameter\":\r\n        case \"port\":\r\n          return par.extras.value;\r\n        case \"constant\":\r\n        case \"variable\":\r\n          return par.extras.name;\r\n        case \"built-in-constant\":\r\n          return par.name;\r\n        default:\r\n          return \"error on node type\";\r\n      }\r\n    });\r\n  }\r\n  function indentCode(original: string) {\r\n    let code: any[] = [];\r\n    let level = 0;\r\n    let tab = \"    \";\r\n    original.split(\"\\n\").forEach((line) => {\r\n      if (line.includes(\"}\")) {\r\n        level--;\r\n      }\r\n      code.push(tab.repeat(Math.max(level, 0)) + line);\r\n      if (line.includes(\"{\")) {\r\n        level++;\r\n      }\r\n    });\r\n    return code.join(\"\\n\");\r\n  }\r\n  function warnAboutNodesWithoutLinks(nodes: any) {\r\n    nodes.forEach((node: any) => {\r\n      let hasLink = false;\r\n      node.ports.forEach((port: any) => {\r\n        if (port.links.length > 0) {\r\n          hasLink = true;\r\n        }\r\n      });\r\n      if (!hasLink) {\r\n        warn(\"This component has no links\", node);\r\n      }\r\n    });\r\n  }\r\n  function warnAboutPortUsage() {\r\n    usedDigital.forEach((port) => {\r\n      if (port.extras.value >= controller?.extras.digitalPorts) {\r\n        warn(\r\n          `This ${port.name} does not exist on this micro - controller`,\r\n          port\r\n        );\r\n      }\r\n    });\r\n    usedAnalog.forEach((port) => {\r\n      if (port.extras.value >= controller?.extras.analogPorts) {\r\n        warn(\r\n          `This ${port.name} does not exist on this micro - controller`,\r\n          port\r\n        );\r\n      }\r\n    });\r\n  }\r\n  function warnAboutMultipleUsePorts(nodes: any) {\r\n    nodes\r\n      .filter((node: any) => paramTypes.includes(node.extras.type))\r\n      .forEach((node: any) => {\r\n        node.ports.forEach((port: any) => {\r\n          // console.log(\"checking \", port);\r\n          if (port.links.length > 1) {\r\n            warn(\r\n              `This ${node.name.toLowerCase()} has more than one link in the same ${port.label\r\n              } port.`,\r\n              node\r\n            );\r\n          } else {\r\n            if (port.name !== \"in\" && port.links.length === 0) {\r\n              warn(`This ${node.name.toLowerCase()} is not being used.`, node);\r\n            }\r\n          }\r\n        });\r\n      });\r\n  }\r\n  function warnAboutLooseLinks(links: any) {\r\n    links.forEach((link: any) => {\r\n      const fromPort = getPort(link.source, link.sourcePort);\r\n      const fromNode = getNode(fromPort?.parentNode);\r\n      const toPort = getPort(link.target, link.targetPort);\r\n      if (!toPort) {\r\n        warn(\"Loose link\", fromNode);\r\n      }\r\n    });\r\n  }\r\n  function warnAboutExpectedVersusReceived(\r\n    port: any,\r\n    node: any,\r\n    expected: any[],\r\n    received: any[]\r\n  ) {\r\n    const expMin = expected.filter((e: any) => !e.includes(\"=\")).length;\r\n    const expMax = expected.length;\r\n\r\n    if (received.length < expMin || received.length > expMax) {\r\n      const count = expMin === expMax ? expMin : `${expMin} to ${expMax}`;\r\n      warn(\r\n        `The function call \"${port.name}\" is receiving ${received.length} parameters instead of the expected ${count}`,\r\n        node,\r\n        port\r\n      );\r\n      return \"error\";\r\n    }\r\n    return \"ok\";\r\n  }\r\n\r\n  function getLinksFromModel(model: any) {\r\n    const temp: any[] = [];\r\n    Object.entries(model.layers[0].models).forEach((link: any) => {\r\n      temp.push(link[1]);\r\n    });\r\n    return temp;\r\n  }\r\n  function getNodesFromModel(model: any) {\r\n    const temp: any[] = [];\r\n    Object.entries(model.layers[1].models).forEach((node: any) => {\r\n      temp.push(node[1]);\r\n    });\r\n    return temp;\r\n  }\r\n  function getComponentsFromNodes(nodes: any) {\r\n    let temp: any[] = [];\r\n    nodes\r\n      .filter((node: any) => node.extras?.type === \"component\")\r\n      .forEach((node: any) => {\r\n        node.instance =\r\n          node.name.toLowerCase().replace(\" \", \"\") +\r\n          temp.filter((t) => t.extras?.library === node.extras?.library).length;\r\n        temp.push(node);\r\n      });\r\n    return temp;\r\n  }\r\n  function warnAboutNumberOfControllers() {\r\n    const controllers: any[] = nodes.filter(\r\n      (node) => node.extras?.type === \"controller\"\r\n    );\r\n    if (controllers.length === 0) {\r\n      warn(\"No micro-controller\");\r\n    }\r\n    if (controllers.length > 1) {\r\n      controllers.forEach((controller) => {\r\n        warn(\"More than one micro-controller\", controller);\r\n      });\r\n    }\r\n  }\r\n  function add(...message: string[]) {\r\n    message.forEach((m) => {\r\n      code += m;\r\n    });\r\n    code += \"\\n\";\r\n    return code;\r\n  }\r\n  function addHeaderComments() {\r\n    add(\"/* Code generated for \", controller?.name);\r\n    const uniqueDigitals = [...new Set(usedDigital.map((u) => u.extras.value))];\r\n    const uniqueAnalogs = [...new Set(usedAnalog.map((u) => u.extras.value))];\r\n\r\n    add(\r\n      `Analog ports ${uniqueAnalogs.length} /${controller?.extras.analogPorts\r\n      } ${usedAnalog.length > 0 ? `(${uniqueAnalogs.map((port) => port)})` : \"\"\r\n      } `\r\n    );\r\n    add(\r\n      `Digital ports ${uniqueDigitals.length}/${controller?.extras.digitalPorts\r\n      } ${usedDigital.length > 0 ? `(${uniqueDigitals.map((port) => port)})` : \"\"\r\n      }`,\r\n      \"    */\"\r\n    );\r\n  }\r\n  function getLink(linkID: string) {\r\n    return links.find((l) => l.id === linkID);\r\n  }\r\n  function getPort(nodeID: string, portID: string) {\r\n    try {\r\n      return nodes\r\n        .find((n: any) => n.id === nodeID)\r\n        .ports.find((p: any) => p.id === portID);\r\n    } catch (error) {\r\n      return null;\r\n    }\r\n  }\r\n  /**\r\n   * Only to be used for paramTypes !\r\n   */\r\n  function getOutPort(inPort: any) {\r\n    try {\r\n      const node = getNode(inPort.parentNode);\r\n      const portPosition = node.portsInOrder.indexOf(inPort.id);\r\n      const outPortId = node.portsOutOrder[portPosition];\r\n      const outPort = node.ports.find((p: { id: any }) => p.id === outPortId);\r\n      return outPort;\r\n    } catch (error) {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  function getNode(nodeID: string) {\r\n    return nodes.find((n: any) => n.id === nodeID);\r\n  }\r\n  function getParent(childNode: any) {\r\n    return nodes.find((n: any) => n.id === childNode.parentNode);\r\n  }\r\n  function warn(message: string, node: any = null, port: any = null) {\r\n    problems.push({ message, node, port });\r\n    return problems;\r\n  }\r\n  function addLifecycleMethods() {\r\n    add(\"\");\r\n    add(`// Micro-controller's Lifecycle`);\r\n    controller?.ports.forEach((port: any) => {\r\n      add(\"void \", port.label, \"{\");\r\n      port.links.forEach((l: any) => {\r\n        processLink(l);\r\n      });\r\n      add(\"}\\n\");\r\n    });\r\n  }\r\n  // #endregion\r\n\r\n  // #region Unreviewed Functions\r\n  function processLink(l: any) {\r\n    function callWithParameters(port: any, params: any) {\r\n      const node = getNode(port.parentNode);\r\n      console.log(\"callWithParmeters\", port, node, params);\r\n      if (node?.name === \"Function\") {\r\n        if (port.name === \"declare\") {\r\n          declareFunction(node);\r\n          return;\r\n        }\r\n      }\r\n\r\n      const expected =\r\n        port.name\r\n          ?.split(\"(\")[1]\r\n          ?.split(\")\")[0]\r\n          ?.split(\",\")\r\n          ?.filter((x: any) => x !== \"\") || [];\r\n      const received: any[] = [];\r\n\r\n      params.forEach((p: any) => {\r\n        if (paramTypes.includes(p.extras.type)) {\r\n          received.push(\r\n            ...p.extras.value\r\n              .split(\",\")\r\n              .map((m: any) => p.extras.returnType + \" \" + m)\r\n          );\r\n        }\r\n      });\r\n\r\n      if (\r\n        warnAboutExpectedVersusReceived(port, node, expected, received) ===\r\n        \"error\"\r\n      )\r\n        return;\r\n\r\n      expected.forEach((ex: any, index: number) => {\r\n        const expectedType =\r\n          returnTypes.find((rt: any) => ex.trim().startsWith(rt)) ||\r\n          node.extras?.returnType;\r\n        const re = received[index];\r\n\r\n        if (ex.includes(\"=\") && !re) {\r\n          //uses default value\r\n        } else {\r\n          const receivedType = returnTypes.find((rt: any) => re.startsWith(rt));\r\n\r\n          if (expectedType !== receivedType) {\r\n            warn(\r\n              `The function call \"${port.name}\" expects its ${ordinals[index]} parameter to be of type \"${expectedType}\", received \"${receivedType}\" instead`,\r\n              node,\r\n              port\r\n            );\r\n          }\r\n        }\r\n      });\r\n\r\n      if (node?.instance) {\r\n        add(\r\n          node.instance +\r\n          \".\" +\r\n          port.name.substring(\r\n            port.name.indexOf(\" \") + 1,\r\n            port.name.indexOf(\"(\")\r\n          ) +\r\n          \"(\" +\r\n          formattedParameters(params) +\r\n          \")\" +\r\n          \";\"\r\n        );\r\n      } else if (fromNode?.instance) {\r\n        add(fromNode.instance + \".\" + fromPort.name + \"();\");\r\n      } else if (port.name.startsWith(\"void setValue\")) {\r\n        let variableParams = formattedParameters(params);\r\n\r\n        // variableParams = variableParams.split(',')\r\n        // console.log('adding', node.extras.name, variableParams)\r\n        add(node.extras.name + \" = \" + variableParams);\r\n      } else if (node.extras.type === \"built-in\") {\r\n        add(\r\n          port.name.substring(\r\n            port.name.indexOf(\" \") + 1,\r\n            port.name.indexOf(\"(\")\r\n          ) +\r\n          \"(\" +\r\n          formattedParameters(params) +\r\n          \")\" +\r\n          \";\"\r\n        );\r\n      } else if (node.extras.type === \"logic\") {\r\n        if (node.name === \"Function\") {\r\n          add(node.extras.value + \"()\");\r\n        } else if (node.name === \"Condition\") {\r\n          const xValue = getCoditionalValue(node, \"void set(T xValue)\");\r\n          const yValue = getCoditionalValue(node, \"void set(T yValue)\");\r\n\r\n          const outcomePort2 = getOutcome(node);\r\n          const toNode2 = getParent(outcomePort2);\r\n\r\n          const outcomePort3 = getOutcome(node, \"else\");\r\n          const toNode3 = getParent(outcomePort3);\r\n\r\n          add(\"if (\", xValue, \" \" + node.extras.value + \" \", yValue, \") {\");\r\n          if (toNode2) {\r\n            outcomePort2.links.forEach((l: any) => {\r\n              processLink(l);\r\n            });\r\n          } else {\r\n            add(\"/* Lacking code to be executed if conditional is true */\");\r\n          }\r\n          if (toNode3) {\r\n            add(\"} else {\");\r\n            outcomePort3.links.forEach((l: any) => {\r\n              processLink(l);\r\n            });\r\n            // callWithParameters(toNode3);\r\n          }\r\n          add(\"}\\n\");\r\n        } else {\r\n          console.log(\"almost confused\", node);\r\n          add(node.extras.value);\r\n        }\r\n      } else {\r\n        console.log(\"confusion at \", port, node, fromNode);\r\n        add(\"confusion\");\r\n        // warn('Loose connection', [fromNode]);\r\n      }\r\n      // try {\r\n      //     if (node.extras.type === 'constant') {\r\n      //         contents.push(node.extras.name);\r\n      //     } else {\r\n      //         contents.push(node.extras.value);\r\n      //     }\r\n      // } catch (error) {\r\n      //     console.log('error, no parameter?');\r\n      // }\r\n      // node.ports.forEach((port: any) => {\r\n      //     port.links.forEach((l: any) => {\r\n      //         const link = getLink(l);\r\n      //         const toPort = getPort(link.target, link.targetPort);\r\n      //         const toNode = getNode(toPort?.parentNode);\r\n      //         if (!toNode) {\r\n      //         } else if (toNode?.id === node?.id) { //skip as it is the previous link\r\n      //             if (toNode.instance) {\r\n      //                 add(toNode.instance + '.' + toPort.name.split(\"(\").shift() + '(' + contents + ');');\r\n      //             }\r\n      //         } else if (toNode?.extras?.type === 'built-in') {\r\n      //             add(toPort.name.split(\"(\").shift() + '(' + contents + ');');\r\n      //         } else if (!toNode?.instance) { //points to another variable/port\r\n      //             callWithParameters(toNode, ...extrass);\r\n      //         } else { //points to a class instance, we hope it is a method call\r\n      //             //todo: check for parameter type and numbers\r\n      //             add(toNode.instance + '.' + (toPort.name.split(\"(\").shift()) + '(' + contents + ');');\r\n      //         }\r\n      //     });\r\n      // });\r\n    }\r\n    function getCoditionalValue(conditionNode: any, portName: any): string {\r\n      try {\r\n        let linkID = conditionNode.ports.find((p: any) => p.name === portName)\r\n          .links[0];\r\n        let link = getLink(linkID);\r\n        let port = getPort(link.source, link.sourcePort);\r\n        let parent = getParent(port);\r\n\r\n        if (paramTypes.includes(parent.extras.type)) {\r\n          return parent.extras.value;\r\n        } else if ([\"component\"].includes(parent.extras.type)) {\r\n          return parent.instance + \".\" + port.name;\r\n        } else {\r\n          return add(\"/* Unknown extras.type */\");\r\n        }\r\n      } catch (error) {\r\n        return \"/* Lacking Value */\";\r\n      }\r\n    }\r\n    function getOutcome(conditionNode: any, ifThis = \"body\") {\r\n      try {\r\n        let linkID = conditionNode.ports.find((p: any) => p.name === ifThis)\r\n          .links[0];\r\n        let link = getLink(linkID);\r\n        return getPort(link.target, link.targetPort);\r\n      } catch (error) {\r\n        return { label: \"// Lacking Outcome\" };\r\n      }\r\n    }\r\n\r\n    const link = getLink(l);\r\n    if (!link) return;\r\n    const fromPort = getPort(link.source, link.sourcePort);\r\n    const fromNode = getNode(fromPort.parentNode);\r\n    const toPort = getPort(link.target, link.targetPort);\r\n    if (!toPort) return;\r\n\r\n    const params: any[] = [];\r\n\r\n    function resolveTarget(\r\n      toPort: any,\r\n      params: any[]\r\n    ): { toPort: any; params: any[] } {\r\n      const toNode = getNode(toPort.parentNode);\r\n\r\n      if (paramTypes.includes(toNode?.extras?.type)) {\r\n        params.push(toNode);\r\n\r\n        let nextFromPort = getOutPort(toPort);\r\n        if (!nextFromPort) return { toPort: undefined, params };\r\n        let nextLink = getLink(nextFromPort.links[0]);\r\n        if (!nextLink) return { toPort: undefined, params };\r\n        let nextToPort = getPort(nextLink.target, nextLink.targetPort);\r\n        if (!nextToPort) return { toPort: undefined, params };\r\n        let nextToNode = getNode(nextToPort.parentNode);\r\n\r\n        if (paramTypes.includes(nextToNode?.extras?.type)) {\r\n          return resolveTarget(nextToPort, params);\r\n        }\r\n        return { toPort: nextToPort, params };\r\n      }\r\n      return { toPort: toPort, params };\r\n    }\r\n\r\n    const target: any = resolveTarget(toPort, params);\r\n    if (target.toPort) callWithParameters(target.toPort, target.params);\r\n\r\n    // if (toNode?.extras?.type === 'built-in') {\r\n    //     add(toPort.name + '()');\r\n    // } else if (toNode?.name === \"Function\") {\r\n    //     add(toNode.extras.value, '(', ');');\r\n    // } else if (toNode?.name === \"Condition\") {\r\n\r\n    // }\r\n  }\r\n\r\n  // function oldRemoveTypes(name: string): string {\r\n  //     const firstSpace = name.indexOf(' ') + 1;\r\n  //     const openningRound = name.indexOf('(');\r\n  //     const closingRound = name.indexOf(')');\r\n\r\n  //     const functionName = name.substring(firstSpace, openningRound);\r\n  //     const params = name.substring(openningRound + 1, closingRound).split(',');\r\n  //     let result = functionName;\r\n  //     params.forEach(param => {\r\n  //         if (!param.includes('=')) {\r\n  //             let thisParam = String(param.split(' ').slice(-1));\r\n  //             result += thisParam;\r\n  //         }\r\n  //     });\r\n  //     console.log('removing types from \"', name, '\" params ', params, ' returning :', result);\r\n  //     return result;\r\n  // }\r\n\r\n  // #endregion\r\n\r\n  // #region Shared Variables\r\n  let code = \"\";\r\n  const problems: any[] = [];\r\n\r\n  const links: any[] = getLinksFromModel(model);\r\n  const nodes: any[] = getNodesFromModel(model);\r\n  const logics: any[] = nodes.filter((node) => node.extras?.type === \"logic\");\r\n  const components: any[] = getComponentsFromNodes(nodes);\r\n  const controller = nodes.find((node) => node.extras?.type === \"controller\");\r\n  const constants: any[] = nodes\r\n    .filter((node) => node.extras?.type === \"constant\")\r\n    .map((constant) => {\r\n      constant.extras.name = constant.extras.name.toUpperCase();\r\n      return constant;\r\n    });\r\n  const variables: any[] = nodes.filter(\r\n    (node) => node.extras?.type === \"variable\"\r\n  );\r\n\r\n  const usedDigital: any[] = [\r\n    ...new Set(nodes.filter((node) => node.extras?.portType === \"Digital\")),\r\n  ];\r\n  const usedAnalog: any[] = [\r\n    ...new Set(nodes.filter((node) => node.extras?.portType === \"Analog\")),\r\n  ];\r\n  // #endregion\r\n\r\n  // #region Generator Lifecycle\r\n  console.log(\"----- Starting Code Generation -----\");\r\n  addHeaderComments();\r\n  warnAboutNumberOfControllers();\r\n  warnAboutPortUsage();\r\n  warnAboutNodesWithoutLinks(nodes);\r\n  warnAboutMultipleUsePorts(nodes);\r\n  warnAboutLooseLinks(links);\r\n  addLibraries();\r\n  addFunctionDeclarations(logics.filter((l) => l.name === \"Function\"));\r\n  addConstantDeclarations(constants);\r\n  addVariableDeclarations(variables);\r\n  addLifecycleMethods();\r\n  // #endregion\r\n  return { code: indentCode(code), problems };\r\n}\r\nexport default function Code(props: { model: string }) {\r\n  // console.log('CodeComponent render')\r\n\r\n  const model = props.model;\r\n  let code = \"\";\r\n  let problems: any[] = [];\r\n  let uniqueProblems: any[] = [];\r\n\r\n  if (model === \"{}\" || model === \"\") {\r\n  } else {\r\n    ({ code, problems } = generateCode(JSON.parse(model)));\r\n\r\n    uniqueProblems = problems.filter((problem, index, self) => {\r\n      return index === self.findIndex((p) => p.message === problem.message);\r\n    });\r\n  }\r\n\r\n  useEffect(() => {\r\n    Prism.highlightAll();\r\n  }, [props]);\r\n  return (\r\n    <div className=\"Code\">\r\n      <div\r\n        style={{\r\n          border:\r\n            problems.length !== 0 ? \"solid yellow 2px\" : \"dotted black 2px\",\r\n        }}\r\n      >\r\n        <div\r\n          style={{\r\n            border:\r\n              problems.length !== 0 ? \"solid yellow 1px\" : \"dotted white 1px\",\r\n            fontSize: \"1em\",\r\n          }}\r\n        >\r\n          {problems.length} Problems!\r\n        </div>\r\n        {uniqueProblems.map((p: any, index: any) => {\r\n          const problemNodes = problems\r\n            .filter((problem) => problem.message === p.message)\r\n            .map((problem) => problem.node);\r\n\r\n          // console.log(problemNodes);\r\n\r\n          let nodes: any[] = [];\r\n          let links: any[] = [];\r\n\r\n          problemNodes.forEach((pn) => {\r\n            if (pn?.id) {\r\n              const el = document.querySelector(`[data-nodeid='${pn.id}']`);\r\n              if (el) el.setAttribute(\"id\", pn.id);\r\n\r\n              ({ nodes, links } = processDynamic(pn, 0, false, p.port));\r\n            }\r\n          });\r\n\r\n          const problemId = p.node\r\n            ? \"problem-\" + p.node.id + index\r\n            : \"problem-nodeless\" + index;\r\n\r\n          return (\r\n            <div\r\n              id={problemId}\r\n              key={problemId}\r\n              style={{ fontSize: \"0.6em\", border: \"solid white 1px\" }}\r\n            >\r\n              Model violation: {p.message}\r\n              {p.node && (\r\n                <>\r\n                  <a\r\n                    data-tip\r\n                    data-for={\"tip-\" + problemId}\r\n                    style={{ float: \"left\", marginRight: \"6px\" }}\r\n                  >\r\n                    <OpenInNewIcon style={{ fontSize: \"1rem\" }} />\r\n                  </a>\r\n                  <ReactTooltip\r\n                    className=\"interactableTooltip\"\r\n                    id={\"tip-\" + problemId}\r\n                    type=\"light\"\r\n                    place=\"bottom\"\r\n                    delayHide={500}\r\n                    effect=\"solid\"\r\n                  >\r\n                    <div className=\"miniGoHolder\">\r\n                      <GoClass linkdata={links} nodedata={nodes} />\r\n                    </div>\r\n                  </ReactTooltip>\r\n                </>\r\n              )}\r\n              {problemNodes.map((pn) => {\r\n                if (pn?.id) return (\r\n                  <div\r\n                    key={index}\r\n                    style={{\r\n                      display: \"flex\",\r\n                      justifyContent: \"space-evenly\",\r\n                      width: \"100%\",\r\n                    }}\r\n                  >\r\n                    <Xarrow\r\n                      strokeWidth={2}\r\n                      start={problemId}\r\n                      end={pn.id}\r\n                      color=\"yellow\"\r\n                    />\r\n                  </div>\r\n                )\r\n                return <></>;\r\n              })}\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n      <pre\r\n        style={{\r\n          height: \"100%\",\r\n          overflow: \"auto\",\r\n        }}\r\n      >\r\n        <code className=\"language-clike\">{code}</code>\r\n      </pre>\r\n    </div >\r\n  );\r\n}\r\n","import * as React from 'react';\r\nimport { Application } from '../components/react-diagrams/Application';\r\nimport { TrayItemWidget } from '../components/react-diagrams/TrayItemWidget';\r\nimport { CanvasWidget } from '@projectstorm/react-canvas-core';\r\nimport { MyCanvasWidget } from '../components/react-diagrams/MyCanvasWidget';\r\nimport styled from '@emotion/styled';\r\nimport { MyEditableNodeModel } from '../components/react-diagrams/editableNode/MyEditableNodeModel';\r\nimport PaletteNodes from '../PaletteNodes.jsx';\r\nimport { useState, useEffect } from 'react';\r\nimport Code from '../components/Code';\r\nvar ScrollArea = require('react-scrollbar').default;\r\n\r\nconst app = new Application();\r\n\r\nnamespace S {\r\n  export const Body = styled.div`\r\n\t\tflex-grow: 1;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tmin-height: 100%;\r\n\t\twidth: 100%;\r\n\t\tgrid-template-columns: 55% 1fr;\r\n\t`;\r\n\r\n  export const Content = styled.div`\r\n\t\tdisplay: flex;\r\n\t\tflex-grow: 1;\r\n\t\t\r\n\t`;\r\n\r\n  export const Layer = styled.div`\r\n\t\tposition: relative;\r\n\t\tflex-grow: 1;\r\n\t`;\r\n\r\n  export const Code = styled.div`\r\n\t\tposition: absolute;\r\n\t\tbackground-color: #2d2d2d ;\r\n\t\tleft:60%;\r\n\t\ttop:0;\r\n\t\tright:0;\r\n\t\tbottom:0;\r\n\t\tmargin:0;\r\n\t\tpadding:0;\r\n\t\t`;\r\n\r\n}\r\n\r\nfunction EditorPage() {\r\n  const [model, setModel] = useState(\"{}\")\r\n  const [rerender, setRerender] = React.useState(false);\r\n\r\n  const rawModel = app.getDiagramEngine().getModel().serialize()\r\n  const stringModel = JSON.stringify(rawModel, null, 2)\r\n\r\n  const groups = [...new Set(PaletteNodes.map(x => x.extras.group || x.extras.type))]\r\n  useEffect(() => {\r\n    if (stringModel !== model) {\r\n      setModel(stringModel);\r\n    }\r\n  }, [stringModel, model]);\r\n\r\n  return (\r\n    <S.Body>\r\n      <S.Content >\r\n        <div>\r\n          <ScrollArea\r\n            speed={1}\r\n            className=\"area\"\r\n            contentClassName=\"content\"\r\n            horizontal={false}\r\n            style={{ height: '100vh' }}\r\n            smoothScrolling={true}\r\n            verticalScrollbarStyle={{ backgroundColor: 'white' }}\r\n          >\r\n            {\r\n              groups.map((group) => {\r\n                return <div key={group} style={{ border: 'dashed white 1px', marginBottom: '20px' }}>\r\n                  <h6 style={{ margin: '0px 0px 0px 0px' }}>{group[0].toUpperCase() + group.slice(1) + 's'}:</h6>\r\n                  {PaletteNodes.filter(n => (n.extras.group === group || n.extras.type === group)).map((node) => {\r\n                    return <TrayItemWidget key={node.name} node={node} />\r\n                  })}\r\n                </div>\r\n              }\r\n              )\r\n            }\r\n          </ScrollArea>\r\n        </div>\r\n        <S.Layer\r\n          onDrop={(event) => {\r\n            let data = JSON.parse(event.dataTransfer.getData('storm-diagram-node'));\r\n            if (data) {\r\n              let node: any = {};\r\n\r\n              app.getDiagramEngine().getModel().registerListener({\r\n                linksUpdated: (l: any) => {\r\n                  setRerender(!rerender);\r\n                  // console.log(\"link\\n\");\r\n                },\r\n                nodesUpdated: (n: any) => {\r\n                  setRerender(!rerender);\r\n                  // console.log(\"node\")\r\n                }\r\n              })\r\n              node = new MyEditableNodeModel(data);\r\n\r\n              node.setPosition(app.getDiagramEngine().getRelativeMousePoint(event));\r\n              app.getDiagramEngine().getModel().addNode(node);\r\n            }\r\n            setRerender(!rerender);\r\n          }}\r\n          onDragOver={(event: any) => {\r\n            event.preventDefault();\r\n          }}\r\n          onClick={(event: any) => {\r\n            setRerender(!rerender);\r\n          }}\r\n        >\r\n          <div style={{ width: '100%', height: '100%' }}>\r\n            <MyCanvasWidget >\r\n              <CanvasWidget engine={app.getDiagramEngine()} />\r\n            </MyCanvasWidget>\r\n          </div>\r\n        </S.Layer>\r\n      </S.Content>\r\n      <S.Code>\r\n        <Code model={model} />\r\n      </S.Code>\r\n    </S.Body >\r\n  )\r\n\r\n}\r\nexport default React.memo(EditorPage)","/* eslint-disable @typescript-eslint/no-unused-vars */\r\nimport './App.css';\r\nimport NavigationBar from './components/NavigationBar'\r\nimport { Routes, Route } from \"react-router-dom\";\r\nimport EditorPage from './pages/Editor'\r\nimport HomePage from './pages/Home';\r\nimport ModelsPage from './pages/Models';\r\nimport TransformationsPage from './pages/Transformations';\r\nimport ManualPage from './pages/Manual';\r\nimport SettingsPage from './pages/Settings';\r\n\r\nexport default function App() {\r\n  return (\r\n    <div className=\"App\">\r\n      <header className=\"App-header\">\r\n        <EditorPage />\r\n        {/* <Routes >\r\n          <Route path='/mdd4/' element={<HomePage />} />\r\n          <Route path='/mdd4/models' element={<ModelsPage />} />\r\n          <Route path='/mdd4/transformations' element={<TransformationsPage />} />\r\n          <Route path='/mdd4/manual' element={<ManualPage />} />\r\n          <Route path='/mdd4/editor' element={<EditorPage />} />\r\n          <Route path='/mdd4/settings' element={<SettingsPage />} />\r\n        </Routes>\r\n        <NavigationBar /> */}\r\n      </header>\r\n    </div>\r\n  );\r\n}\r\n\r\n","import ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport { BrowserRouter } from 'react-router-dom'\r\n\r\nReactDOM.render(\r\n  <BrowserRouter>\r\n    <App />\r\n  </BrowserRouter>,\r\n  document.getElementById('root')\r\n);\r\n\r\n\r\n"],"sourceRoot":""}